# Post Exploitation Metasploit Modules

### Multiplatform post exploitation modules <a id="multiplatform_post_exploitation_modules"></a>

#### Extract credentials \(Multiplatform\) <a id="extract_credentials_multiplatform"></a>

| Metasploit module | Description |
| :--- | :--- |
| use post/multi/gather/aws\_keys | **UNIX Gather AWS Keys** This module will attempt to read AWS configuration files \(.aws/config, .aws//credentials and .s3cfg\) for users discovered on the session’d system and extract AWS keys from within. Platforms: unix \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/multi/gather/aws_keys.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/multi/gather/aws_keys.md), [ref1](http://s3tools.org/kb/item14.htm), [ref2](https://docs.aws.amazon.com/cli/latest/userguide/cli-chap-getting-started.html#cli-config-files)\) |
| use post/multi/gather/dbvis\_enum | **Multi Gather DbVisualizer Connections Settings** DbVisualizer stores the user database configuration in dbvis.xml. This module retrieves the connections settings from this file and decrypts the encrypted passwords. Platforms: linux, win \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/multi/gather/dbvis_enum.rb)\) |
| use post/multi/gather/docker\_creds | **Multi Gather Docker Credentials Collection** This module will collect the contents of all users’ .docker directories on the targeted machine. If the user has already push to docker hub, chances are that the password was saved in base64 \(default behavior\). Platforms: bsd, linux, osx, unix \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/multi/gather/docker_creds.rb)\) |
| use post/multi/gather/fetchmailrc\_creds | **UNIX Gather .fetchmailrc Credentials** Post Module to obtain credentials saved for IMAP, POP and other mail retrieval protocols in fetchmail’s .fetchmailrc. Platforms: bsd, linux, osx, unix \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/multi/gather/fetchmailrc_creds.rb)\) |
| use post/multi/gather/filezilla\_client\_cred | **Multi Gather FileZilla FTP Client Credential Collection** This module will collect credentials from the FileZilla FTP client if it is installed. Platforms: bsd, linux, osx, unix, win \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/multi/gather/filezilla_client_cred.rb)\) |
| use post/multi/gather/gpg\_creds | **Multi Gather GnuPG Credentials Collection** This module will collect the contents of all users’ .gnupg directories on the targeted machine. Password protected secret keyrings can be cracked with John the Ripper \(JtR\). Platforms: bsd, linux, osx, unix \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/multi/gather/gpg_creds.rb)\) |
| use post/multi/gather/grub\_creds | **Gather GRUB Password** This module gathers GRUB passwords from GRUB bootloader config files. Platforms: linux, osx, unix, solaris, bsd \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/multi/gather/grub_creds.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/multi/gather/grub_creds.md), [ref1](https://help.ubuntu.com/community/Grub2/Passwords#Password_Encryption)\) |
| use post/multi/gather/irssi\_creds | **Multi Gather IRSSI IRC Password\(s\)** This module grabs IRSSI IRC credentials. Platforms: bsd, linux, osx, unix \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/multi/gather/irssi_creds.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/multi/gather/irssi_creds.md)\) |
| use post/multi/gather/jboss\_gather | **Jboss Credential Collector** This module can be used to extract the Jboss admin passwords for version 4,5 and 6. Platforms: linux, win \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/multi/gather/jboss_gather.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/multi/gather/jboss_gather.md)\) |
| use post/multi/gather/jenkins\_gather | **Jenkins Credential Collector** This module can be used to extract saved Jenkins credentials, user tokens, SSH keys, and secrets. Interesting files will be stored in loot along with combined csv output. Platforms: linux, win \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/multi/gather/jenkins_gather.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/multi/gather/jenkins_gather.md)\) |
| use post/multi/gather/lastpass\_creds | **LastPass Vault Decryptor** This module extracts and decrypts LastPass master login accounts and passwords, encryption keys, 2FA tokens and all the vault passwords. Platforms: linux, osx, unix, win \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/multi/gather/lastpass_creds.rb), [ref1](http://www.martinvigo.com/even-the-lastpass-will-be-stolen-deal-with-it)\) |
| use post/multi/gather/maven\_creds | **Multi Gather Maven Credentials Collection** This module will collect the contents of all users’ settings.xml \(Apache Maven configuration file\) on the targeted machine. Platforms: bsd, linux, osx, unix, win \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/multi/gather/maven_creds.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/multi/gather/maven_creds.md)\) |
| use post/multi/gather/netrc\_creds | **UNIX Gather .netrc Credentials** This module obtains credentials for FTP and other services saved in the .netrc for each user. Platforms: bsd, linux, osx, unix \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/multi/gather/netrc_creds.rb)\) |
| use post/multi/gather/pgpass\_creds | **Multi Gather pgpass Credentials** This module will collect the contents of all users’ .pgpass or pgpass.conf file and parse them for credentials. Platforms: linux, bsd, unix, osx, win \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/multi/gather/pgpass_creds.rb)\) |
| use post/multi/gather/pidgin\_cred | **Multi Gather Pidgin Instant Messenger Credential Collection** This module will collect credentials from the Pidgin IM client if it is installed. Platforms: bsd, linux, osx, unix, win \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/multi/gather/pidgin_cred.rb)\) |
| use post/multi/gather/remmina\_creds | **UNIX Gather Remmina Credentials** Post module to obtain credentials saved for RDP and VNC from Remmina’s configuration files. Platforms: bsd, linux, osx, unix \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/multi/gather/remmina_creds.rb)\) |
| use post/multi/gather/rsyncd\_creds | **UNIX Gather RSYNC Credentials** Post Module to obtain credentials saved for RSYNC in various locations. Platforms: linux, osx, unix, solaris, bsd \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/multi/gather/rsyncd_creds.rb)\) |
| use post/multi/gather/rubygems\_api\_key | **Multi Gather RubyGems API Key** This module obtains a user’s RubyGems API key from ~/.gem/credentials. Platforms: bsd, linux, osx, unix \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/multi/gather/rubygems_api_key.rb)\) |
| use post/multi/gather/ssh\_creds | **Multi Gather OpenSSH PKI Credentials Collection** This module will collect the contents of all users’ .ssh directories on the targeted machine. Additionally, known\_hosts and authorized\_keys files are also downloaded. Platforms: bsd, linux, osx, unix \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/multi/gather/ssh_creds.rb)\) |
| use post/multi/gather/thunderbird\_creds | **Multi Gather Mozilla Thunderbird Signon Credential Collection** This module will collect credentials from Mozilla Thunderbird by downloading the necessary files such as ‘signons.sqlite’, ‘key3.db’, and ‘cert8.db’ for offline decryption with third party tools. Platforms: linux, osx, win \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/multi/gather/thunderbird_creds.rb)\) |
| use post/multi/gather/tomcat\_gather | **Gather Tomcat Credentials** This module will attempt to collect credentials from Tomcat services running on the machine. Platforms: win, linux \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/multi/gather/tomcat_gather.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/multi/gather/tomcat_gather.md)\) |

Go [back to menu](https://www.infosecmatter.com/post-exploitation-metasploit-modules-reference/#toc).

#### Privilege escalation \(Multiplatform\) <a id="privilege_escalation_multiplatform"></a>

| Metasploit module | Description |
| :--- | :--- |
| use post/multi/escalate/aws\_create\_iam\_user | **Create an AWS IAM User** This module will attempt to create an AWS \(Amazon Web Services\) IAM \(Identity and Access Management\) user with Admin privileges. Platforms: unix \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/multi/escalate/aws_create_iam_user.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/multi/escalate/aws_create_iam_user.md), [ref1](https://github.com/devsecops/bootcamp/raw/master/Week-6/slides/june-DSO-bootcamp-week-six-lesson-three.pdf)\) |
| use post/multi/escalate/cups\_root\_file\_read | **CUPS 1.6.1 Root File Read** This module exploits the CVE-2012-5519 vulnerability in CUPS &lt; 1.6.2, an open source printing system. The vulnerability allows to read arbitrary files \(as root\) on the system. Platforms: linux, osx \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/multi/escalate/cups_root_file_read.rb), [ref1](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=692791)\) |
| use post/multi/escalate/metasploit\_pcaplog | **Multi Escalate Metasploit pcap\_log Local Privilege Escalation** Metasploit &lt; 4.4 contains a vulnerable ‘pcap\_log’ plugin which, when used with the default settings, creates pcap files in /tmp with predictable file names. A successful exploitation results in the creation of a new superuser account. Platforms: bsd, linux, unix \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/multi/escalate/metasploit_pcaplog.rb), [ref1](https://0a29.blogspot.com/2012/07/0a29-12-2-metasploit-pcaplog-plugin.html), [ref2](https://community.rapid7.com/docs/DOC-1946)\) |
| use post/multi/recon/local\_exploit\_suggester | **Multi Recon Local Exploit Suggester** This module suggests local meterpreter exploits that can be used. The exploits are suggested based on the architecture, session type and the platform of the target. Platforms: all\_platforms \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/multi/recon/local_exploit_suggester.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/multi/recon/local_exploit_suggester.md)\) |
| use post/multi/recon/multiport\_egress\_traffic | **Generate TCP/UDP Outbound Traffic On Multiple Ports** This module generates TCP or UDP traffic across a sequence of ports, and is useful for finding firewall holes and egress filtering. Platforms: linux, osx, unix, solaris, bsd, windows \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/multi/recon/multiport_egress_traffic.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/multi/recon/multiport_egress_traffic.md)\) |
| use post/multi/recon/sudo\_commands | **Sudo Commands** This module examines the sudoers configuration for the session user and lists the commands executable via sudo. It also inspects each command and reports potential avenues for privileged code execution due to poor file system permissions or permitting execution of executables known to be useful for privesc. Platforms: bsd, linux, osx, solaris, unix \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/multi/recon/sudo_commands.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/multi/recon/sudo_commands.md)\) |

Go [back to menu](https://www.infosecmatter.com/post-exploitation-metasploit-modules-reference/#toc).

#### Information gathering \(Multiplatform\) <a id="information_gathering_multiplatform"></a>

| Metasploit module | Description |
| :--- | :--- |
| use post/multi/gather/apple\_ios\_backup | **Windows Gather Apple iOS MobileSync Backup File Collection** This module will collect sensitive files from any on-disk iOS device backups. Platforms: osx, win \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/multi/gather/apple_ios_backup.rb)\) |
| use post/multi/gather/aws\_ec2\_instance\_metadata | **Gather AWS EC2 Instance Metadata** This module will attempt to connect to the AWS EC2 instance metadata service and crawl and collect all metadata known about the session’d host. Platforms: unix \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/multi/gather/aws_ec2_instance_metadata.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/multi/gather/aws_ec2_instance_metadata.md), [ref1](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-instance-metadata.html)\) |
| use post/multi/gather/check\_malware | **Multi Gather Malware Verifier** This module will check a file for malware on VirusTotal based on the checksum. Platforms: osx, win, linux \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/multi/gather/check_malware.rb)\) |
| use post/multi/gather/dns\_bruteforce | **Multi Gather DNS Forward Lookup Bruteforce** Brute force subdomains and hostnames via wordlist. Platforms: bsd, linux, osx, solaris, win \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/multi/gather/dns_bruteforce.rb)\) |
| use post/multi/gather/dns\_reverse\_lookup | **Multi Gather DNS Reverse Lookup Scan** Performs DNS reverse lookup using the OS included DNS query command. Platforms: bsd, linux, osx, solaris, win \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/multi/gather/dns_reverse_lookup.rb)\) |
| use post/multi/gather/dns\_srv\_lookup | **Multi Gather DNS Service Record Lookup Scan** Enumerates known SRV Records for a given domain using target host DNS query tool. Platforms: bsd, linux, osx, solaris, win \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/multi/gather/dns_srv_lookup.rb)\) |
| use post/multi/gather/enum\_hexchat | **Linux Gather HexChat/XChat Enumeration** This module will collect HexChat and XChat’s config files and chat logs from the victim’s machine, including channel settings, channel/server passwords, etc. Platforms: linux \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/multi/gather/enum_hexchat.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/multi/gather/enum_hexchat.md), [ref1](https://hexchat.readthedocs.io/en/latest/settings.html)\) |
| use post/multi/gather/enum\_software\_versions | **Multiplatform Installed Software Version Enumerator** This module will gather details on all installed software, including their versions and if available, when they were installed, and will save it into a loot file for later use. This can be used to determine what additional vulnerabilites may affect the target machine. Platforms: win, linux, osx, bsd, solaris, android \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/multi/gather/enum_software_versions.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/multi/gather/enum_software_versions.md)\) |
| use post/multi/gather/enum\_vbox | **Multi Gather VirtualBox VM Enumeration** This module will attempt to enumerate any VirtualBox VMs on the target machine belonging to the current user. Platforms: bsd, linux, osx, unix, win \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/multi/gather/enum_vbox.rb)\) |
| use post/multi/gather/env | **Multi Gather Generic Operating System Environment Settings** This module prints out the operating system environment variables. Platforms: linux, win \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/multi/gather/env.rb)\) |
| use post/multi/gather/find\_vmx | **Multi Gather VMWare VM Identification** This module will attempt to find any VMWare virtual machines stored on the target. Platforms: bsd, linux, osx, unix, win \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/multi/gather/find_vmx.rb)\) |
| use post/multi/gather/multi\_command | **Multi Gather Run Shell Command Resource File** This module will read shell commands from a resource file and execute the commands in the specified meterpreter or shell session. Platforms: bsd, linux, osx, unix, win \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/multi/gather/multi_command.rb)\) |
| use post/multi/gather/ping\_sweep | **Multi Gather Ping Sweep** Performs IPv4 ping sweep using the OS included ping command. Platforms: bsd, linux, osx, solaris, win \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/multi/gather/ping_sweep.rb)\) |
| use post/multi/gather/resolve\_hosts | **Multi Gather Resolve Hosts** Resolves hostnames to either IPv4 or IPv6 addresses from the perspective of the remote host. Platforms: win, python \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/multi/gather/resolve_hosts.rb)\) |
| use post/multi/gather/run\_console\_rc\_file | **Multi Gather Run Console Resource File** This module will read console commands from a resource file and execute the commands in the specified Meterpreter session. Platforms: win \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/multi/gather/run_console_rc_file.rb)\) |
| use post/multi/gather/skype\_enum | **Multi Gather Skype User Data Enumeration** This module will enumerate Skype account settings, contact list, call history, chat logs, file transfer history, and voicemail logs, saving all the data to CSV files for analysis. Platforms: osx, win \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/multi/gather/skype_enum.rb)\) |
| use post/multi/gather/ubiquiti\_unifi\_backup | **Multi Gather Ubiquiti UniFi Controller Backup** On an Ubiquiti UniFi controller, reads the system.properties configuration file and downloads the backup and autobackup files. The files are then decrypted using a known encryption key, then attempted to be repaired by zip. Platforms: linux, win, osx \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/multi/gather/ubiquiti_unifi_backup.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/multi/gather/ubiquiti_unifi_backup.md), [ref1](https://github.com/zhangyoufu/unifi-backup-decrypt/), [ref2](https://github.com/justingist/POSH-Ubiquiti/blob/master/Posh-UBNT.psm1), [ref3](https://help.ubnt.com/hc/en-us/articles/205202580-UniFi-system-properties-File-Explanation), [ref4](https://community.ubnt.com/t5/UniFi-Wireless/unf-controller-backup-file-format/td-p/1624105)\) |
| use post/multi/gather/wlan\_geolocate | **Multiplatform WLAN Enumeration and Geolocation** Enumerate wireless networks visible to the target device. Optionally geolocate the target by gathering local wireless networks and performing a lookup against Google APIs. Platforms: android, osx, win, linux, bsd, solaris \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/multi/gather/wlan_geolocate.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/multi/gather/wlan_geolocate.md)\) |

Go [back to menu](https://www.infosecmatter.com/post-exploitation-metasploit-modules-reference/#toc).

#### Spy / Capture \(Multiplatform\) <a id="spy__capture_multiplatform"></a>

| Metasploit module | Description |
| :--- | :--- |
| use post/multi/manage/record\_mic | **Multi Manage Record Microphone** This module will enable and record your target’s microphone. For non-Windows targets, use the Java meterpreter to be able to use this feature. Platforms: linux, osx, win \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/multi/manage/record_mic.rb)\) |

Go [back to menu](https://www.infosecmatter.com/post-exploitation-metasploit-modules-reference/#toc).

#### General / Other \(Multiplatform\) <a id="general__other_multiplatform"></a>

| Metasploit module | Description |
| :--- | :--- |
| use post/multi/general/close | **Multi Generic Operating System Session Close** This module closes the specified session. This can be useful as a finisher for automation tasks. Platforms: linux, osx, unix, win \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/multi/general/close.rb)\) |
| use post/multi/general/execute | **Multi Generic Operating System Session Command Execution** This module executes an arbitrary command line. Platforms: linux, osx, unix, win \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/multi/general/execute.rb)\) |
| use post/multi/general/wall | **Write Messages to Users** This module utilizes the wall\(1\) or write\(1\) utilities, as appropriate, to send messages to users on the target system. Platforms: linux, osx, unix \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/multi/general/wall.rb)\) |
| use post/multi/manage/autoroute | **Multi Manage Network Route via Meterpreter Session** This module enables network routing via an existing meterpreter session. It enables other modules to ‘pivot’ through a compromised host. Autoadd will search a session for valid subnets from the routing table and interface list and then automatically add routes to them. Platforms: \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/multi/manage/autoroute.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/multi/manage/autoroute.md)\) |
| use post/multi/manage/dbvis\_add\_db\_admin | **Multi Manage DbVisualizer Add Db Admin** This modules creates an administrator account in the database accessed via the DbVisualizer management and analysis tool. Note: This module currently only supports MySQL. Platforms: linux, win \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/multi/manage/dbvis_add_db_admin.rb), [ref1](https://youtu.be/0LCLRVHX1vA)\) |
| use post/multi/manage/dbvis\_query | **Multi Manage DbVisualizer Query** This modules allows to execute SQL queries in the database accessed via the DbVisualizer management and analysis tool. Platforms: linux, win \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/multi/manage/dbvis_query.rb), [ref1](https://youtu.be/0LCLRVHX1vA)\) |
| use post/multi/manage/multi\_post | **Multi Manage Post Module Macro Execution** This module will execute a list of modules given in a macro file in the format of &lt;module&gt; &lt;opt=val,opt=val&gt; against the select meterpreter or shell session. Platforms: linux, osx, solaris, unix, win \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/multi/manage/multi_post.rb)\) |
| use post/multi/manage/open | **Open a file or URL on the target computer** This module will open any file or URL specified with the URI format on the target computer via the embedded commands such as ‘open’ or ‘xdg-open’. Platforms: osx, linux, win \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/multi/manage/open.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/multi/manage/open.md)\) |
| use post/multi/manage/play\_youtube | **Multi Manage YouTube Broadcast** This module will broadcast a YouTube video on specified compromised systems. It will play the video in the target machine’s native browser. Platforms: win, osx, linux, android, unix \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/multi/manage/play_youtube.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/multi/manage/play_youtube.md)\) |
| use post/multi/manage/screensaver | **Multi Manage the screensaver of the target computer** This module allows you to turn on or off the screensaver of the target computer and also lock the current session. Platforms: linux, osx, win \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/multi/manage/screensaver.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/multi/manage/screensaver.md)\) |
| use post/multi/manage/screenshare | **Multi Manage the screen of the target meterpreter session** This module allows you to view and control the screen of the target computer via a local browser window. The module continually screenshots the target screen and also relays all mouse and keyboard events to session. Platforms: linux, win, osx \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/multi/manage/screenshare.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/multi/manage/screenshare.md)\) |
| use post/multi/manage/set\_wallpaper | **Multi Manage Set Wallpaper** This module will set the desktop wallpaper background on the specified session. Platforms: win, osx, linux, android \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/multi/manage/set_wallpaper.rb)\) |
| use post/multi/manage/shell\_to\_meterpreter | **Shell to Meterpreter Upgrade** This module attempts to upgrade a command shell to meterpreter. The shell platform is automatically detected and the best version of meterpreter for the target is selected. Platforms: linux, osx, unix, solaris, bsd, windows \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/multi/manage/shell_to_meterpreter.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/multi/manage/shell_to_meterpreter.md)\) |
| use post/multi/manage/sudo | **Multiple Linux / Unix Post Sudo Upgrade Shell** This module attempts to upgrade a shell account to UID 0 by reusing the given password and passing it to sudo. Platforms: aix, linux, osx, solaris, unix \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/multi/manage/sudo.rb), [ref1](https://www.sudo.ws/repos/sudo/file/05780f5f71fd/sudo.h)\) |
| use post/multi/manage/system\_session | **Multi Manage System Remote TCP Shell Session** This module will create a Reverse TCP Shell on the target system using the system’s own scripting environments installed on the target. Platforms: linux, osx, unix \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/multi/manage/system_session.rb)\) |
| use post/multi/manage/upload\_exec | **Upload and Execute** This modules allows to push a file on the remote system and execute it. Platforms: win, unix, linux, osx, bsd, solaris \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/multi/manage/upload_exec.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/multi/manage/upload_exec.md)\) |
| use post/multi/manage/zip | **Multi Manage File Compressor** This module zips a file or a directory on the remote system. Platforms: win, linux \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/multi/manage/zip.rb)\) |

Go [back to menu](https://www.infosecmatter.com/post-exploitation-metasploit-modules-reference/#toc).

### Windows post exploitation modules <a id="windows_post_exploitation_modules"></a>

#### Extract credentials \(Windows\) <a id="extract_credentials_windows"></a>

| Metasploit module | Description |
| :--- | :--- |
| use post/windows/capture/lockout\_keylogger | **Windows Capture Winlogon Lockout Credential Keylogger** This module migrates and logs Microsoft Windows user’s passwords via Winlogon.exe using idle time and natural system changes to give a false sense of security to the user. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/capture/lockout_keylogger.rb), [ref1](http://blog.metasploit.com/2010/12/capturing-windows-logons-with.html)\) |
| use post/windows/gather/bitlocker\_fvek | **Bitlocker Master Key \(FVEK\) Extraction** This module enumerates ways to decrypt Bitlocker volume and if a recovery key is stored locally or can be generated, dump the Bitlocker master key \(FVEK\). \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/bitlocker_fvek.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/windows/gather/bitlocker_fvek.md), [ref1](https://github.com/libyal/libbde/blob/master/documentation/BitLocker%20Drive%20Encryption%20%28BDE%29%20format.asciidoc), [ref2](http://www.hsc.fr/ressources/outils/dislocker/)\) |
| use post/windows/gather/cachedump | **Windows Gather Credential Cache Dump** This module uses the registry to extract the stored domain hashes that have been cached as a result of a GPO setting. The default setting on Windows is to store the last ten successful logins. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/cachedump.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/windows/gather/cachedump.md), [ref1](http://lab.mediaservice.net/code/cachedump.rb)\) |
| use post/windows/gather/credentials/credential\_collector | **Windows Gather Credential Collector** This module harvests credentials \(hashes and access tokens\) found on the host and stores them in the database. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/credentials/credential_collector.rb)\) |
| use post/windows/gather/credentials/enum\_cred\_store | **Windows Gather Credential Store Enumeration and Decryption Module** This module will enumerate the Microsoft Credential Store and decrypt the credentials. This module can only access credentials created by the user the process is running as. It cannot decrypt Domain Network Passwords, but will display the username and location. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/credentials/enum_cred_store.rb)\) |
| use post/windows/gather/credentials/mssql\_local\_hashdump | **Windows Gather Local SQL Server Hash Dump** This module extracts the usernames and password hashes from an MSSQL server and stores them as loot. It uses the same technique in mssql\_local\_auth\_bypass. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/credentials/mssql_local_hashdump.rb), [ref1](https://www.dionach.com/blog/easily-grabbing-microsoft-sql-server-password-hashes)\) |
| use post/windows/gather/credentials/outlook | **Windows Gather Microsoft Outlook Saved Password Extraction** This module extracts and decrypts saved Microsoft Outlook \(versions 2002-2010\) passwords from the Windows Registry for POP3/IMAP/SMTP/HTTP accounts. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/credentials/outlook.rb)\) |
| use post/windows/gather/credentials/rdc\_manager\_creds | **Windows Gather Remote Desktop Connection Manager Saved Password Extraction** This module extracts and decrypts saved Microsoft Remote Desktop Connection Manager \(RDCMan\) passwords the .RDG files of users. The module will attempt to find the files configured for all users on the target system. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/credentials/rdc_manager_creds.rb)\) |
| use post/windows/gather/credentials/skype | **Windows Gather Skype Saved Password Hash Extraction** This module finds saved login credentials for the Windows Skype client found in the Config.xml file. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/credentials/skype.rb), [ref1](https://www.recon.cx/en/f/vskype-part2.pdf), [ref2](http://insecurety.net/?p=427), [ref3](https://github.com/skypeopensource/tools)\) |
| use post/windows/gather/credentials/sso | **Windows Single Sign On Credential Collector \(Mimikatz\)** This module will collect cleartext Single Sign On credentials from the Local Security Authority using the Kiwi \(Mimikatz\) extension. Blank passwords will not be stored in the database. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/credentials/sso.rb)\) |
| use post/windows/gather/credentials/windows\_autologin | **Windows Gather AutoLogin User Credential Extractor** This module extracts plain-text Windows AutoLogin passwords from Registry stored in the HKLM\Software\Microsoft\Windows NT\WinLogon location, which is readable by all users. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/credentials/windows_autologin.rb), [ref1](https://support.microsoft.com/kb/315231), [ref2](http://core.yehg.net/lab/#tools.exploits)\) |
| use post/windows/gather/enum\_snmp | **Windows Gather SNMP Settings Enumeration \(Registry\)** This module will enumerate the SNMP service configuration, including stored community strings \(SNMP authentication\). \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/enum_snmp.rb)\) |
| use post/windows/gather/enum\_unattend | **Windows Gather Unattended Answer File Enumeration** This module will check the file system for a copy of unattend.xml and/or autounattend.xml found in Windows Vista, or newer Windows systems. And then extract sensitive information such as usernames and decoded passwords. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/enum_unattend.rb), [ref1](https://technet.microsoft.com/en-us/library/ff715801), [ref2](https://technet.microsoft.com/en-us/library/cc749415%28v=ws.10%29.aspx), [ref3](https://technet.microsoft.com/en-us/library/c026170e-40ef-4191-98dd-0b9835bfa580)\) |
| use post/windows/gather/hashdump | **Windows Gather Local User Account Password Hashes \(Registry\)** This module will dump the local user accounts from the SAM database using the registry. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/hashdump.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/windows/gather/hashdump.md)\) |
| use post/windows/gather/lsa\_secrets | **Windows Enumerate LSA Secrets** This module will attempt to enumerate the LSA Secrets keys found in the registry under the HKEY\_LOCAL\_MACHINE\Security\Policy\Secrets\ location. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/lsa_secrets.rb)\) |
| use post/windows/gather/netlm\_downgrade | **Windows NetLM Downgrade Attack** This module will change a registry value to enable the sending of LM challenge hashes and then initiate a SMB connection to the SMBHOST datastore. If an SMB server is listening, it will receive the NetLM hashes. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/netlm_downgrade.rb), [ref1](https://www.optiv.com/blog/post-exploitation-using-netntlm-downgrade-attacks)\) |
| use post/windows/gather/phish\_windows\_credentials | **Windows Gather User Credentials \(phishing\)** This module is able to perform a phishing attack on the target by popping up a loginprompt. When the user fills credentials in the loginprompt, the credentials will be sent to the attacker. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/phish_windows_credentials.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/windows/gather/phish_windows_credentials.md), [ref1](https://forsec.nl/2015/02/windows-credentials-phishing-using-metasploit)\) |
| use post/windows/gather/smart\_hashdump | **Windows Gather Local and Domain Controller Account Password Hashes** This will dump local accounts from the SAM Database. If the target host is a Domain Controller, it will dump the Domain Account Database using the proper technique depending on privilege level, OS and role of the host. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/smart_hashdump.rb)\) |
| use post/windows/gather/word\_unc\_injector | **Windows Gather Microsoft Office Word UNC Path Injector** This module modifies a remote .docx file that will, upon opening, submit stored netNTLM credentials to a remote host. Verified to work with Microsoft Word 2003, 2007, 2010, and 2013. In order to get the hashes the auxiliary/server/capture/smb module can be used. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/word_unc_injector.rb), [ref1](https://web.archive.org/web/20140527232608/http://jedicorp.com/?p=534)\) |
| use post/windows/manage/wdigest\_caching | **Windows Post Manage WDigest Credential Caching** On Windows 8/2012 or higher, the Digest Security Provider \(WDIGEST\) is disabled by default. This module enables/disables credential caching by adding/changing the value of the UseLogonCredential DWORD under the WDIGEST provider’s Registry key. Any subsequent logins will allow mimikatz to recover the plain text passwords from the system’s memory. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/manage/wdigest_caching.rb)\) |

Go [back to menu](https://www.infosecmatter.com/post-exploitation-metasploit-modules-reference/#toc).

#### Extract credentials \(3rd party applications\) <a id="extract_credentials_3rd_party_applications"></a>

| Metasploit module | Description |
| :--- | :--- |
| use post/windows/gather/credentials/purevpn\_cred\_collector | **Windows Gather PureVPN Client Credential Collector** Finds the password stored for the PureVPN Client. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/credentials/purevpn_cred_collector.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/windows/gather/credentials/purevpn_cred_collector.md), [ref1](https://www.trustwave.com/Resources/SpiderLabs-Blog/Credential-Leak-Flaws-in-Windows-PureVPN-Client/), [ref2](https://www.trustwave.com/Resources/Security-Advisories/Advisories/TWSL2018-010/?fid=11779)\) |
| use post/windows/gather/credentials/avira\_password | **Windows Gather Avira Password Extraction** This module extracts password from the Avira Antivirus \(≤ 15.0.17.273\). \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/credentials/avira_password.rb)\) |
| use post/windows/gather/credentials/bulletproof\_ftp | **Windows Gather BulletProof FTP Client Saved Password Extraction** This module extracts information from the BulletProof FTP client including bookmarks and credentials and saves them in the database. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/credentials/bulletproof_ftp.rb)\) |
| use post/windows/gather/credentials/coreftp | **Windows Gather CoreFTP Saved Password Extraction** This module extracts saved passwords from the CoreFTP FTP client from registry. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/credentials/coreftp.rb)\) |
| use post/windows/gather/credentials/dynazip\_log | **Windows Gather DynaZIP Saved Password Extraction** This module extracts clear text credentials from dynazip.log file, which contains passwords used to encrypt compressed zip files in Microsoft Plus! 98 and Windows Me. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/credentials/dynazip_log.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/windows/gather/credentials/dynazip_log.md), [ref1](https://support.microsoft.com/en-us/kb/265131)\) |
| use post/windows/gather/credentials/dyndns | **Windows Gather DynDNS Client Password Extractor** This module extracts the username, password, and hosts for DynDNS version 4.1.8. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/credentials/dyndns.rb)\) |
| use post/windows/gather/credentials/enum\_picasa\_pwds | **Windows Gather Google Picasa Password Extractor** This module extracts and decrypts the login passwords stored by Google Picasa. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/credentials/enum_picasa_pwds.rb)\) |
| use post/windows/gather/credentials/epo\_sql | **Windows Gather McAfee ePO 4.6 Config SQL Credentials** This module extracts connection details and decrypts the saved password for the SQL database in use by a McAfee ePO 4.6 server. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/credentials/epo_sql.rb)\) |
| use post/windows/gather/credentials/filezilla\_server | **Windows Gather FileZilla FTP Server Credential Collection** This module will collect credentials from the installed FileZilla FTP server. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/credentials/filezilla_server.rb)\) |
| use post/windows/gather/credentials/flashfxp | **Windows Gather FlashFXP Saved Password Extraction** This module extracts saved FTP passwords from the FlashFXP client and its Sites.dat file. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/credentials/flashfxp.rb)\) |
| use post/windows/gather/credentials/ftpnavigator | **Windows Gather FTP Navigator Saved Password Extraction** This module extracts saved passwords from the FTP Navigator FTP client. It will decode the saved passwords and store them in the database. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/credentials/ftpnavigator.rb)\) |
| use post/windows/gather/credentials/ftpx | **Windows Gather FTP Explorer \(FTPX\) Credential Extraction** This module finds saved login credentials in profiles.xml configuration file of the FTP Explorer \(FTPx\) client. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/credentials/ftpx.rb)\) |
| use post/windows/gather/credentials/heidisql | **Windows Gather HeidiSQL Saved Password Extraction** This module extracts saved passwords from the HeidiSQL client from the registry. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/credentials/heidisql.rb)\) |
| use post/windows/gather/credentials/idm | **Windows Gather Internet Download Manager \(IDM\) Password Extractor** This module recovers premium download account passwords from the Internet Download Manager \(IDM\) stored in registry. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/credentials/idm.rb)\) |
| use post/windows/gather/credentials/imail | **Windows Gather IPSwitch iMail User Data Enumeration** This module will collect iMail user data such as the username, domain, full name, e-mail, and the decoded password. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/credentials/imail.rb)\) |
| use post/windows/gather/credentials/imvu | **Windows Gather Credentials IMVU Game Client** This module extracts account username & password from the IMVU game client and stores it as loot. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/credentials/imvu.rb)\) |
| use post/windows/gather/credentials/mcafee\_vse\_hashdump | **McAfee Virus Scan Enterprise Password Hashes Dump** This module extracts the password hash from McAfee Virus Scan Enterprise \(VSE\) used to lock down the user interface. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/credentials/mcafee_vse_hashdump.rb), [ref1](https://www.dionach.com/blog/disabling-mcafee-on-access-scanning)\) |
| use post/windows/gather/credentials/mdaemon\_cred\_collector | **Windows Gather MDaemonEmailServer Credential Cracking** This module extracts passwords of the MDaemon Email Server. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/credentials/mdaemon_cred_collector.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/windows/gather/credentials/mdaemon_cred_collector.md)\) |
| use post/windows/gather/credentials/meebo | **Windows Gather Meebo Password Extractor** This module extracts login password of the Meebo Notifier, a desktop version of the Meebo’s Online Messenger. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/credentials/meebo.rb)\) |
| use post/windows/gather/credentials/mremote | **Windows Gather mRemote Saved Password Extraction** This module extracts saved passwords from mRemote connection manager. The mRemote stores connections for RDP, VNC, SSH, Telnet, rlogin and other protocols. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/credentials/mremote.rb)\) |
| use post/windows/gather/credentials/nimbuzz | **Windows Gather Nimbuzz Instant Messenger Password Extractor** This module extracts account passwords saved by the Nimbuzz Instant Messenger. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/credentials/nimbuzz.rb)\) |
| use post/windows/gather/credentials/razer\_synapse | **Windows Gather Razer Synapse Password Extraction** This module will enumerate passwords stored by the Razer Synapse client. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/credentials/razer_synapse.rb), [ref1](http://www.pentestgeek.com/2013/01/16/hard-coded-encryption-keys-and-more-wordpress-fun/), [ref2](https://github.com/pasv/Testing/blob/master/Razer_decode.py)\) |
| use post/windows/gather/credentials/razorsql | **Windows Gather RazorSQL Credentials** This module extracts credentials and other information from the RazorSQL db client, stored in the profiles.txt configuration file. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/credentials/razorsql.rb)\) |
| use post/windows/gather/credentials/securecrt | **Windows SecureCRT Session Information Enumeration** This module will extract credentials from the SecureCRT SSH and Telnet client configuration files. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/credentials/securecrt.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/windows/gather/credentials/securecrt.md), [ref1](https://github.com/HyperSine/how-does-SecureCRT-encrypt-password/blob/master/doc/how-does-SecureCRT-encrypt-password.md)\) |
| use post/windows/gather/credentials/smartermail | **Windows Gather SmarterMail Password Extraction** This module extracts and decrypts the sysadmin password from the SmarterMail ‘mailConfig.xml’ configuration file. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/credentials/smartermail.rb), [ref1](http://www.gironsec.com/blog/tag/cracking-smartermail/)\) |
| use post/windows/gather/credentials/smartftp | **Windows Gather SmartFTP Saved Password Extraction** This module finds saved login credentials in the SmartFTP FTP client configuration files. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/credentials/smartftp.rb)\) |
| use post/windows/gather/credentials/spark\_im | **Windows Gather Spark IM Password Extraction** This module will enumerate passwords stored by the Spark IM client. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/credentials/spark_im.rb), [ref1](https://adamcaudill.com/2012/07/27/decrypting-spark-saved-passwords/)\) |
| use post/windows/gather/credentials/steam | **Windows Gather Steam Client Session Collector.** This module will collect Steam session information from an account set to autologin. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/credentials/steam.rb)\) |
| use post/windows/gather/credentials/teamviewer\_passwords | **Windows Gather TeamViewer Passwords** This module will find and decrypt stored TeamViewer passwords. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/credentials/teamviewer_passwords.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/windows/gather/credentials/teamviewer_passwords.md), [ref1](https://whynotsecurity.com/blog/teamviewer/), [ref2](https://www.cnblogs.com/Kali-Team/p/12468066.html)\) |
| use post/windows/gather/credentials/tortoisesvn | **Windows Gather TortoiseSVN Saved Password Extraction** This module extracts and decrypts saved TortoiseSVN passwords. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/credentials/tortoisesvn.rb)\) |
| use post/windows/gather/credentials/total\_commander | **Windows Gather Total Commander Saved Password Extraction** This module extracts weakly encrypted saved FTP Passwords from Total Commander, stored in the wcx\_ftp.ini configuration file. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/credentials/total_commander.rb)\) |
| use post/windows/gather/credentials/trillian | **Windows Gather Trillian Password Extractor** This module extracts account password from Trillian & Trillian Astra v4.x-5.x instant messenger. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/credentials/trillian.rb)\) |
| use post/windows/gather/credentials/vnc | **Windows Gather VNC Password Extraction** This module extracts DES encrypted passwords for VNC servers \(UltraVNC, RealVNC, WinVNC, TightVNC etc.\) from known registry locations. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/credentials/vnc.rb)\) |
| use post/windows/gather/credentials/winscp | **Windows Gather WinSCP Saved Password Extraction** This module extracts weakly encrypted saved passwords from the WinSCP client, stored in registry and in the WinSCP.ini configuration file. Note that it cannot decrypt passwords if a master password is used. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/credentials/winscp.rb)\) |
| use post/windows/gather/credentials/wsftp\_client | **Windows Gather WS\_FTP Saved Password Extraction** This module extracts weakly encrypted saved FTP Passwords from the WS\_FTP client, stored in the ws\_ftp.ini file. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/credentials/wsftp_client.rb)\) |
| use post/windows/gather/credentials/xshell\_xftp\_password | **Windows Gather Xshell and Xftp Passwords** This module can decrypt stored \(remembered\) passwords from Xshell and Xftp – SSH, FTP and Telnet clients. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/credentials/xshell_xftp_password.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/windows/gather/credentials/xshell_xftp_password.md), [ref1](https://github.com/HyperSine/how-does-Xmanager-encrypt-password/blob/master/doc/how-does-Xmanager-encrypt-password.md)\) |
| use post/windows/gather/enum\_putty\_saved\_sessions | **Name** This module will identify whether Pageant \(PuTTY Agent\) is running and obtain saved session information from the registry, including credentials. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/enum_putty_saved_sessions.rb)\) |
| use post/windows/gather/enum\_tomcat | **Windows Gather Apache Tomcat Enumeration** This module will collect information from a Windows-based Apache Tomcat, including the installation path, version, port, deployed web applications, users, passwords, roles, etc. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/enum_tomcat.rb)\) |

Go [back to menu](https://www.infosecmatter.com/post-exploitation-metasploit-modules-reference/#toc).

#### Information gathering \(Windows\) <a id="information_gathering_windows"></a>

| Metasploit module | Description |
| :--- | :--- |
| use post/windows/gather/enum\_emet | **Windows Gather EMET Protected Paths** This module will enumerate the EMET protected paths on the target host. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/enum_emet.rb)\) |
| use post/windows/gather/arp\_scanner | **Windows Gather ARP Scanner** This module will perform an ARP scan for a given IP range through a Meterpreter Session. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/arp_scanner.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/windows/gather/arp_scanner.md)\) |
| use post/windows/gather/bitcoin\_jacker | **Windows Gather Bitcoin Wallet** This module downloads any Bitcoin wallet files from the target system. It currently supports both the classic Satoshi wallet and the more recent Armory wallets. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/bitcoin_jacker.rb)\) |
| use post/windows/gather/checkvm | **Windows Gather Virtual Environment Detection** This module attempts to determine whether the system is running inside of a virtual environment and if so, which one. This module supports detection of Hyper-V, VMWare, Virtual PC, VirtualBox, Xen, and QEMU. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/checkvm.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/windows/gather/checkvm.md)\) |
| use post/windows/gather/dnscache\_dump | **Windows Gather DNS Cache** This module displays the records stored in the DNS cache. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/dnscache_dump.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/windows/gather/dnscache_dump.md)\) |
| use post/windows/gather/enum\_applications | **Windows Gather Installed Application Enumeration** This module will enumerate all installed applications on a Windows system. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/enum_applications.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/windows/gather/enum_applications.md)\) |
| use post/windows/gather/enum\_artifacts | **Windows Gather File and Registry Artifacts Enumeration** This module will check the file system and registry for particular artifacts. The list of artifacts is read from data/post/enum\_artifacts\_list.txt or a user specified file. Any matches are written to the loot. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/enum_artifacts.rb)\) |
| use post/windows/gather/enum\_av\_excluded | **Windows Antivirus Exclusions Enumeration** This module will enumerate the file, directory, process and extension-based exclusions from supported AV products, which currently includes Microsoft Defender, Microsoft Security Essentials/Antimalware, and Symantec Endpoint Protection. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/enum_av_excluded.rb)\) |
| use post/windows/gather/enum\_computers | **Windows Gather Enumerate Computers** This module will enumerate computers included in the primary Domain. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/enum_computers.rb)\) |
| use post/windows/gather/enum\_db | **Windows Gather Database Instance Enumeration** This module will enumerate a windows system for installed database instances. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/enum_db.rb)\) |
| use post/windows/gather/enum\_devices | **Windows Gather Hardware Enumeration** Enumerate PCI hardware information from the registry. Please note this script will run through registry subkeys such as: ‘PCI’, ‘ACPI’, ‘ACPI\_HAL’, ‘FDC’, ‘HID ‘HTREE’, ‘IDE’, ‘ISAPNP’, ‘LEGACY”, LPTENUM’, ‘PCIIDE’, ‘SCSI’, ‘STORAGE’, ‘SW and ‘USB’. It is recommended to run this module as a background job. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/enum_devices.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/windows/gather/enum_devices.md)\) |
| use post/windows/gather/enum\_dirperms | **Windows Gather Directory Permissions Enumeration** This module enumerates directories and lists the permissions set on found directories. Note that if the PATH option isn’t specified, then the module will start enumerate whatever is in the target machine’s %PATH% variable. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/enum_dirperms.rb)\) |
| use post/windows/gather/enum\_files | **Windows Gather Generic File Collection** This module downloads files recursively based on the FILE\_GLOBS option. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/enum_files.rb)\) |
| use post/windows/gather/enum\_hostfile | **Windows Gather Windows Host File Enumeration** This module returns a list of entries in the target system’s hosts file. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/enum_hostfile.rb)\) |
| use post/windows/gather/enum\_hyperv\_vms | **Windows Hyper-V VM Enumeration** This module will check if the target machine is a Hyper-V host and, if it is, will return a list of all of the VMs running on the host, as well as stats such as their state, version, CPU Usage, uptime, and status. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/enum_hyperv_vms.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/windows/gather/enum_hyperv_vms.md)\) |
| use post/windows/gather/enum\_logged\_on\_users | **Windows Gather Logged On User Enumeration \(Registry\)** This module will enumerate current and recently logged on Windows users. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/enum_logged_on_users.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/windows/gather/enum_logged_on_users.md)\) |
| use post/windows/gather/enum\_ms\_product\_keys | **Windows Gather Product Key** This module will enumerate the OS license key. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/enum_ms_product_keys.rb)\) |
| use post/windows/gather/enum\_patches | **Windows Gather Applied Patches** This module will attempt to enumerate which patches are applied to a windows system based on the result of the WMI query: SELECT HotFixID, InstalledOn FROM Win32\_QuickFixEngineering. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/enum_patches.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/windows/gather/enum_patches.md), [ref1](https://msdn.microsoft.com/en-us/library/aa394391%28v=vs.85%29.aspx)\) |
| use post/windows/gather/enum\_powershell\_env | **Windows Gather Powershell Environment Setting Enumeration** This module will enumerate Microsoft Powershell settings. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/enum_powershell_env.rb)\) |
| use post/windows/gather/enum\_proxy | **Windows Gather Proxy Setting** This module pulls a user’s proxy settings from the current computer. It can also pull proxy settings from a specific SID \(user\) from another remote host. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/enum_proxy.rb)\) |
| use post/windows/gather/enum\_services | **Windows Gather Service Info Enumeration** This module will query the system for services and display name and configuration info for each returned service. It allows you to optionally search the credentials, path, or start type for a string and only return the results that match. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/enum_services.rb)\) |
| use post/windows/gather/enum\_shares | **Windows Gather SMB Share Enumeration via Registry** This module will enumerate configured and recently used file shares. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/enum_shares.rb)\) |
| use post/windows/gather/enum\_termserv | **Windows Gather Terminal Server Client Connection Information Dumper** This module dumps MRU and connection data for RDP sessions. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/enum_termserv.rb)\) |
| use post/windows/gather/enum\_trusted\_locations | **Windows Gather Microsoft Office Trusted Locations** This module will enumerate the Microsoft Office trusted locations on the target host. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/enum_trusted_locations.rb)\) |
| use post/windows/gather/make\_csv\_orgchart | **Generate CSV Organizational Chart Data Using Manager Information** This module will generate a CSV file containing all users and their managers, which can be imported into Visio which will render it. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/make_csv_orgchart.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/windows/gather/make_csv_orgchart.md)\) |
| use post/windows/gather/memory\_grep | **Windows Gather Process Memory Grep** This module allows for searching the memory space of a process for potentially sensitive data. Please note: When the HEAP option is enabled, the module will have to migrate to the process you are grepping. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/memory_grep.rb)\) |
| use post/windows/gather/outlook | **Windows Gather Outlook Email Messages** This module allows reading and searching email messages from the local Outlook installation using PowerShell. Please note that this module is manipulating the victims keyboard/mouse. If a victim is active on the target system, he/she may notice it. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/outlook.rb), [ref1](https://forsec.nl/2014/11/reading-outlook-using-metasploit)\) |
| use post/windows/gather/psreadline\_history | **Windows Gather PSReadline History** Gathers Power Shell history data from the target machine. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/psreadline_history.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/windows/gather/psreadline_history.md), [ref1](https://docs.microsoft.com/en-us/powershell/module/psreadline/), [ref2](https://github.com/KalibRx/PoshHarvestPy/blob/master/poshharvest.py), [ref3](https://0xdf.gitlab.io/2018/11/08/powershell-history-file.html)\) |
| use post/windows/gather/resolve\_sid | **Windows Gather Local User Account SID Lookup** This module prints information about a given SID from the perspective of this session. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/resolve_sid.rb)\) |
| use post/windows/gather/reverse\_lookup | **Windows Gather IP Range Reverse Lookup** This module uses Railgun, calling the gethostbyaddr function to resolve a hostname to an IP. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/reverse_lookup.rb)\) |
| use post/windows/gather/tcpnetstat | **Windows Gather TCP Netstat** This module lists current TCP sessions. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/tcpnetstat.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/windows/gather/tcpnetstat.md)\) |
| use post/windows/gather/usb\_history | **Windows Gather USB Drive History** This module will enumerate USB Drive history on a target host. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/usb_history.rb)\) |
| use post/windows/gather/win\_privs | **Windows Gather Privileges Enumeration** This module will print if UAC is enabled, and if the current account is ADMIN enabled. It will also print UID, foreground SESSION ID, is SYSTEM status and current process PRIVILEGES. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/win_privs.rb)\) |
| use post/windows/gather/wmic\_command | **Windows Gather Run Specified WMIC Command** This module will execute a given WMIC command options or read WMIC commands options from a resource file and execute the commands. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/wmic_command.rb)\) |
| use post/windows/recon/computer\_browser\_discovery | **Windows Recon Computer Browser Discovery** This module uses railgun to discover hostnames and IPs on the network. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/recon/computer_browser_discovery.rb)\) |
| use post/windows/recon/outbound\_ports | **Windows Outbound-Filtering Rules** This module implements TCP traceroute to a public IP address in order to obtain understanding of outbound-filtering rules in the environment. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/recon/outbound_ports.rb), [ref1](http://www.shelliscoming.com/2014/11/getting-outbound-filtering-rules-by.html)\) |
| use post/windows/recon/resolve\_ip | **Windows Recon Resolve IP** This module reverse resolves a range or IP to a hostname. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/recon/resolve_ip.rb)\) |
| use post/windows/wlan/wlan\_bss\_list | **Windows Gather Wireless BSS Info** This module gathers information about the wireless Basic Service Sets available to the victim machine. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/wlan/wlan_bss_list.rb)\) |
| use post/windows/wlan/wlan\_current\_connection | **Windows Gather Wireless Current Connection Info** This module gathers information about the current connection on each wireless lan interface on the target machine. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/wlan/wlan_current_connection.rb)\) |
| use post/windows/wlan/wlan\_disconnect | **Windows Disconnect Wireless Connection** This module disconnects the current wireless network connection on the specified interface. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/wlan/wlan_disconnect.rb)\) |
| use post/windows/wlan/wlan\_probe\_request | **Windows Send Probe Request Packets** This module send probe requests through the wlan interface. The ESSID field will be use to set a custom message. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/wlan/wlan_probe_request.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/windows/wlan/wlan_probe_request.md)\) |
| use post/windows/wlan/wlan\_profile | **Windows Gather Wireless Profile** This module extracts saved Wireless LAN profiles. It will also try to decrypt the network key material. Behavior is slightly different between OS versions. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/wlan/wlan_profile.rb)\) |

Go [back to menu](https://www.infosecmatter.com/post-exploitation-metasploit-modules-reference/#toc).

#### Privilege escalation \(Windows\) <a id="privilege_escalation_windows"></a>

| Metasploit module | Description |
| :--- | :--- |
| use post/windows/escalate/droplnk | **Windows Escalate SMB Icon LNK Dropper** This module drops a shortcut \(LNK file\) that has a ICON reference existing on the specified remote host, causing SMB and WebDAV connections to be initiated from any user that views the shortcut. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/escalate/droplnk.rb)\) |
| use post/windows/escalate/getsystem | **Windows Escalate Get System via Administrator** This module uses the builtin ‘getsystem’ command to escalate the current session to the SYSTEM account from an administrator user account. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/escalate/getsystem.rb)\) |
| use post/windows/escalate/golden\_ticket | **Windows Escalate Golden Ticket** This module will create a Golden Kerberos Ticket using the Mimikatz Kiwi Extension. If no options are applied it will attempt to identify the current domain, the domain administrator account, the target domain SID, and retrieve the krbtgt NTLM hash from the database. By default the well-known Administrator’s groups 512, 513, 518, 519, and 520 will be applied to the ticket. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/escalate/golden_ticket.rb), [ref1](https://github.com/gentilkiwi/mimikatz/wiki/module-~-kerberos)\) |
| use post/windows/escalate/ms10\_073\_kbdlayout | **Windows Escalate NtUserLoadKeyboardLayoutEx Privilege Escalation** This module exploits the keyboard layout vulnerability exploited by Stuxnet. When processing specially crafted keyboard layout files \(DLLs\), the Windows kernel fails to validate that an array index is within the bounds of the array. By loading a specially crafted keyboard layout, an attacker can execute code in Ring 0. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/escalate/ms10_073_kbdlayout.rb), [ref1](http://www.reversemode.com/index.php?option=com_content&task=view&id=71&Itemid=1)\) |
| use post/windows/escalate/screen\_unlock | **Windows Escalate Locked Desktop Unlocker** This module unlocks a locked Windows desktop by patching the respective code inside the LSASS.exe process. This patching process can result in the target system hanging or even rebooting, so be careful when using this module on production systems. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/escalate/screen_unlock.rb)\) |
| use post/windows/escalate/unmarshal\_cmd\_exec | **Windows unmarshal post exploitation** This module exploits a local privilege escalation bug which exists in microsoft COM for windows when it fails to properly handle serialized objects. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/escalate/unmarshal_cmd_exec.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/windows/escalate/unmarshal_cmd_exec.md), [ref1](https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2018-0824), [ref2](https://github.com/x73x61x6ex6ax61x79/UnmarshalPwn)\) |

Go [back to menu](https://www.infosecmatter.com/post-exploitation-metasploit-modules-reference/#toc).

#### Spy / Capture \(Windows\) <a id="spy__capture_windows"></a>

| Metasploit module | Description |
| :--- | :--- |
| use post/windows/capture/keylog\_recorder | **Windows Capture Keystroke Recorder** This module can be used to capture keystrokes. It is recommended to run this module as a job, otherwise it will tie up your framework user interface. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/capture/keylog_recorder.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/windows/capture/keylog_recorder.md)\) |
| use post/windows/gather/screen\_spy | **Windows Gather Screen Spy** This module will incrementally take desktop screenshots from the host. This allows for screen spying which can be useful to determine if there is an active user on a machine, or to record the screen for later data extraction. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/screen_spy.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/windows/gather/screen_spy.md)\) |
| use post/windows/manage/rpcapd\_start | **Windows Manage Remote Packet Capture Service Starter** This module enables the Remote Packet Capture System \(rpcapd service\) included in the default installation of Winpcap. The module allows you to set up the service in passive or active mode \(useful if the client is behind a firewall\). \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/manage/rpcapd_start.rb)\) |
| use post/windows/manage/webcam | **Windows Manage Webcam** This module will allow the user to detect installed webcams \(with the LIST action\) or take a snapshot \(with the SNAPSHOT\) action. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/manage/webcam.rb)\) |

Go [back to menu](https://www.infosecmatter.com/post-exploitation-metasploit-modules-reference/#toc).

#### Forensics \(Windows\) <a id="forensics_windows"></a>

| Metasploit module | Description |
| :--- | :--- |
| use post/windows/gather/dumplinks | **Windows Gather Dump Recent Files lnk Info** The dumplinks module is a modified port of Harlan Carvey’s lslnk.pl Perl script. This module will parse .lnk files from a user’s Recent Documents folder and Microsoft Office’s Recent Documents folder, if present. Windows creates these link files automatically for many common file types. The .lnk files contain time stamps, file locations, including share names, volume serial numbers, and more. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/dumplinks.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/windows/gather/dumplinks.md)\) |
| use post/windows/gather/enum\_muicache | **Windows Gather Enum User MUICache** This module gathers information from MUICache about the files and file paths that logged on users have executed on the system. It will also check if the files still exist on the system or not. This module works by gathering information stored under the MUICache registry key or in the NTUSER.DAT/UsrClass.dat files. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/enum_muicache.rb)\) |
| use post/windows/gather/enum\_prefetch | **Windows Gather Prefetch File Information** This module gathers prefetch file information from WinXP, Win2k3 and Win7 systems and current values of related registry keys. From each prefetch file it will collect filetime of the last execution, file path hash, run count, filename and the execution path. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/enum_prefetch.rb)\) |
| use post/windows/gather/file\_from\_raw\_ntfs | **Windows File Gather File from Raw NTFS** This module gathers a file using the raw NTFS device, bypassing some Windows restrictions such as open file with write lock. Because it avoids the usual file locking issues, it can be used to retrieve files such as NTDS.dit. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/file_from_raw_ntfs.rb), [ref1](https://www.amazon.com/System-Forensic-Analysis-Brian-Carrier/dp/0321268172/)\) |
| use post/windows/gather/forensics/duqu\_check | **Windows Gather Forensics Duqu Registry Check** This module searches for CVE-2011-3402 \(Duqu\) related registry artifacts. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/forensics/duqu_check.rb), [ref1](https://r-7.co/w5h7fY)\) |
| use post/windows/gather/forensics/enum\_drives | **Windows Gather Physical Drives and Logical Volumes** This module will list physical drives and logical volumes. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/forensics/enum_drives.rb)\) |
| use post/windows/gather/forensics/imager | **Windows Gather Forensic Imaging** This module will perform byte-for-byte imaging of remote disks and volumes. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/forensics/imager.rb)\) |
| use post/windows/gather/forensics/nbd\_server | **Windows Gather Local NBD Server** Maps remote disks and logical volumes to a local Network Block Device server. Allows for forensic tools to be executed on the remote disk directly. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/forensics/nbd_server.rb)\) |
| use post/windows/gather/forensics/recovery\_files | **Windows Gather Deleted Files Enumeration and Recovering** This module lists and attempts to recover deleted files from NTFS file systems. Use the FILES option to adjust the recovery process. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/forensics/recovery_files.rb), [ref1](https://www.youtube.com/watch?v=9yzCf360ujY&hd=1)\) |
| use post/windows/manage/nbd\_server | **Windows Manage Local NBD Server for Remote Disks** Maps remote disks and logical volumes to a local Network Block Device server. Allows for forensic tools to be executed on the remote disk directly. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/manage/nbd_server.rb)\) |

Go [back to menu](https://www.infosecmatter.com/post-exploitation-metasploit-modules-reference/#toc).

#### Generic / Other \(Windows\) <a id="generic__other_windows"></a>

| Metasploit module | Description |
| :--- | :--- |
| use post/windows/manage/killav | **Windows Post Kill Antivirus and Hips** This module attempts to locate and terminate any processes that are identified as being Antivirus or Host-based IPS related. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/manage/killav.rb)\) |
| use post/windows/manage/archmigrate | **Architecture Migrate** This module checks if the meterpreter architecture is the same as the OS architecture and if it’s incompatible it spawns a new process with the correct architecture and migrates into that process. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/manage/archmigrate.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/windows/manage/archmigrate.md)\) |
| use post/windows/manage/change\_password | **Windows Manage Change Password** This module will attempt to change the password of the target account. The typical usage is to change password of a newly created account. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/manage/change_password.rb)\) |
| use post/windows/manage/clone\_proxy\_settings | **Windows Manage Proxy Setting Cloner** This module copies the proxy settings from the current user to the targeted user SID, supports remote hosts as well if remote registry is allowed. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/manage/clone_proxy_settings.rb)\) |
| use post/windows/manage/delete\_user | **Windows Manage Local User Account Deletion** This module deletes a local user account from the specified server, or the local machine if no server is given. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/manage/delete_user.rb)\) |
| use post/windows/manage/download\_exec | **Windows Manage Download and/or Execute** This module will download a file by importing urlmon via railgun. The user may also choose to execute the file with arguments via exec\_string. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/manage/download_exec.rb)\) |
| use post/windows/manage/driver\_loader | **Windows Manage Driver Loader** This module loads a KMD \(Kernel Mode Driver\) using the Windows Service API. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/manage/driver_loader.rb)\) |
| use post/windows/manage/enable\_rdp | **Windows Manage Enable Remote Desktop** This module enables the Remote Desktop Service \(RDP\). It provides the options to create an account and configure it to be a member of the Local Administrators and Remote Desktop Users group. It can also forward the target’s port 3389/tcp. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/manage/enable_rdp.rb)\) |
| use post/windows/manage/enable\_support\_account | **Windows Manage Trojanize Support Account** This module enables alternative access to servers and workstations by modifying the support account’s \(support\_388945a0\) properties. It will enable the account for remote access as the administrator. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/manage/enable_support_account.rb)\) |
| use post/windows/manage/execute\_dotnet\_assembly | **Execute .NET Assembly \(x64 only\)** This module executes a .NET assembly in memory. It reflectively loads a dll that will host CLR, then it copies the assembly to be executed into memory. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/manage/execute_dotnet_assembly.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/windows/manage/execute_dotnet_assembly.md), [ref1](https://b4rtik.blogspot.com/2018/12/execute-assembly-via-meterpreter-session.html)\) |
| use post/windows/manage/exec\_powershell | **Windows Powershell Execution Post Module** This module will execute a powershell script in a meterpreter session. The user may also enter text substitutions to be made in memory before execution. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/manage/exec_powershell.rb)\) |
| use post/windows/manage/forward\_pageant | **Forward SSH Agent Requests To Remote Pageant** This module forwards SSH agent requests from a local socket to a remote Pageant instance. If a target Windows machine is compromised and is running Pageant, this will allow the attacker to run normal OpenSSH commands \(e.g. ssh-add -l\) against the Pageant host which are tunneled through the meterpreter session. This could therefore be used to authenticate with a remote host using a private key which is loaded into a remote user’s Pageant instance, without ever having knowledge of the private key itself. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/manage/forward_pageant.rb)\) |
| use post/windows/manage/hashcarve | **Windows Local User Account Hash Carver** This module will change a local user’s password directly in the registry. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/manage/hashcarve.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/windows/manage/hashcarve.md)\) |
| use post/windows/manage/inject\_ca | **Windows Manage Certificate Authority Injection** This module allows the attacker to insert an arbitrary CA certificate into the victim’s Trusted Root store. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/manage/inject_ca.rb)\) |
| use post/windows/manage/inject\_host | **Windows Manage Hosts File Injection** This module allows the attacker to insert a new entry into the target system’s hosts file. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/manage/inject_host.rb)\) |
| use post/windows/manage/install\_python | **Install Python for Windows** This module places an embeddable Python3 distribution onto the target file system, granting pentesters access to a lightweight Python interpreter. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/manage/install_python.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/windows/manage/install_python.md), [ref1](https://docs.python.org/3/using/windows.html#windows-embeddable), [ref2](https://attack.mitre.org/techniques/T1064/)\) |
| use post/windows/manage/install\_ssh | **Install OpenSSH for Windows** This module installs OpenSSH server and client for Windows using PowerShell. SSH on Windows can provide pentesters persistent access to a secure interactive terminal, interactive filesystem access, and port forwarding over SSH. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/manage/install_ssh.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/windows/manage/install_ssh.md), [ref1](https://docs.microsoft.com/en-us/windows-server/administration/openssh/openssh_overview), [ref2](https://github.com/PowerShell/openssh-portable)\) |
| use post/windows/manage/migrate | **Windows Manage Process Migration** This module will migrate a Meterpreter session from one process to another. A given process PID to migrate to or the module can spawn one and migrate to that newly spawned process. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/manage/migrate.rb)\) |
| use post/windows/manage/mssql\_local\_auth\_bypass | **Windows Manage Local Microsoft SQL Server Authorization Bypass** When this module is executed, it can be used to add a sysadmin to local SQL Server instances. It first attempts to gain LocalSystem privileges using the “getsystem” escalation methods. If those privileges are not sufficient to add a sysadmin, then it will migrate to the SQL Server service process associated with the target instance. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/manage/mssql_local_auth_bypass.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/windows/manage/mssql_local_auth_bypass.md)\) |
| use post/windows/manage/multi\_meterpreter\_inject | **Windows Manage Inject in Memory Multiple Payloads** This module will inject in to several processes a given payload and connecting to a given list of IP Addresses. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/manage/multi_meterpreter_inject.rb)\) |
| use post/windows/manage/peinjector | **Peinjector** This module will inject a specified windows payload into a target executable. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/manage/peinjector.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/windows/manage/peinjector.md)\) |
| use post/windows/manage/persistence\_exe | **Windows Manage Persistent EXE Payload Installer** This module will upload an executable to a remote host and make it persistent. It can be installed as USER, SYSTEM, or SERVICE. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/manage/persistence_exe.rb)\) |
| use post/windows/manage/portproxy | **Windows Manage Set Port Forwarding With PortProxy** This module uses the PortProxy interface from netsh to set up port forwarding persistently \(even after reboot\). PortProxy supports TCP IPv4 and IPv6 connections. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/manage/portproxy.rb)\) |
| use post/windows/manage/powershell/build\_net\_code | **Powershell .NET Compiler** This module will build a .NET source file using powershell. The compiler builds the executable or library in memory and produces a binary. After compilation the PowerShell session can also sign the executable if provided a path the a .pfx formatted certificate. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/manage/powershell/build_net_code.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/windows/manage/powershell/build_net_code.md)\) |
| use post/windows/manage/powershell/exec\_powershell | **Windows Manage PowerShell Download and/or Execute** This module will download and execute a PowerShell script over a meterpreter session. The user may also enter text substitutions to be made in memory before execution. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/manage/powershell/exec_powershell.rb)\) |
| use post/windows/manage/powershell/load\_script | **Load Scripts Into PowerShell Session** This module will download and execute one or more PowerShell script s over a present powershell session. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/manage/powershell/load_script.rb)\) |
| use post/windows/manage/pptp\_tunnel | **Windows Manage Remote Point-to-Point Tunneling Protocol** This module initiates a PPTP connection to a remote machine \(VPN server\). Once the tunnel is created we can use it to force the victim traffic to go through the server getting a man in the middle attack. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/manage/pptp_tunnel.rb), [ref1](https://www.youtube.com/watch?v=vdppEZjMPCM&hd=1)\) |
| use post/windows/manage/priv\_migrate | **Windows Manage Privilege Based Process Migration** This module will migrate a meterpreter session based on session privileges. It will do everything it can to migrate, including spawning a new User level process. For sessions with Admin rights: It will try to migrate into a System level process in the following order: ANAME \(if specified\), services.exe, wininit.exe, svchost.exe, lsm.exe, lsass.exe, and winlogon.exe. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/manage/priv_migrate.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/windows/manage/priv_migrate.md)\) |
| use post/windows/manage/pxeexploit | **Windows Manage PXE Exploit Server** This module provides a PXE server, running a DHCP and TFTP server. The default configuration loads a linux kernel and initrd into memory that reads the hard drive; placing a payload to install metsvc, disable the firewall, and add a new user metasploit on any Windows partition seen, and add a uid 0 user with username and password metasploit to any linux partition seen. The windows user will have the password p@SSw0rd!123456 \(in case of complexity requirements\) and will be added to the administrators group. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/manage/pxeexploit.rb)\) |
| use post/windows/manage/reflective\_dll\_inject | **Windows Manage Reflective DLL Injection Module** This module will inject a specified reflective DLL into the memory of a process, new or existing. If arguments are specified, they are passed to the DllMain entry point as the lpvReserved \(3rd\) parameter. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/manage/reflective_dll_inject.rb), [ref1](https://github.com/stephenfewer/ReflectiveDLLInjection)\) |
| use post/windows/manage/remove\_ca | **Windows Manage Certificate Authority Removal** This module allows the attacker to remove an arbitrary CA certificate from the victim’s Trusted Root store. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/manage/remove_ca.rb)\) |
| use post/windows/manage/remove\_host | **Windows Manage Host File Entry Removal** This module allows the attacker to remove an entry from the Windows hosts file. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/manage/remove_host.rb)\) |
| use post/windows/manage/rid\_hijack | **Windows Manage RID Hijacking** This module will create an entry on the target by modifying some properties of an existing account. It will change the account attributes by setting a Relative Identifier \(RID\), which should be owned by one existing account on the destination machine. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/manage/rid_hijack.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/windows/manage/rid_hijack.md), [ref1](http://csl.com.co/rid-hijacking/)\) |
| use post/windows/manage/rollback\_defender\_signatures | **Disable Windows Defender Signatures** This module with appropriate rights let to use the Windows Defender command-line utility a run and automation tool \(mpcmdrun.exe\) in order to disable all the signatures available installed for the compromised machine. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/manage/rollback_defender_signatures.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/windows/manage/rollback_defender_signatures.md)\) |
| use post/windows/manage/run\_as | **Windows Manage Run Command As User** This module will login with the specified username/password and execute the supplied command as a hidden process. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/manage/run_as.rb)\) |
| use post/windows/manage/run\_as\_psh | **Windows “Run As” Using Powershell** This module will start a process as another user using powershell. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/manage/run_as_psh.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/windows/manage/run_as_psh.md)\) |
| use post/windows/manage/sdel | **Windows Manage Safe Delete** The goal of the module is to hinder the recovery of deleted files by overwriting its contents. This could be useful when you need to download some file on the victim machine and then delete it without leaving clues about its contents. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/manage/sdel.rb)\) |
| use post/windows/manage/shellcode\_inject | **Windows Manage Memory Shellcode Injection Module** This module will inject into the memory of a process a specified shellcode. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/manage/shellcode_inject.rb)\) |
| use post/windows/manage/sshkey\_persistence | **SSH Key Persistence** This module will add an SSH key to a specified user \(or all\), to allow remote login via SSH at any time. The target Windows system has to have OpenSSH server installed. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/manage/sshkey_persistence.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/windows/manage/sshkey_persistence.md)\) |
| use post/windows/manage/sticky\_keys | **Sticky Keys Persistance Module** This module makes it possible to apply the ‘sticky keys’ hack to a session with appropriate rights. The hack provides a means to get a SYSTEM shell using UI-level interaction at an RDP login screen or via a UAC confirmation dialog. The module modifies the Debug registry setting for certain executables \(sethc.exe, utilman.exe, osk.exe or displayswitch.exe\). \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/manage/sticky_keys.rb), [ref1](https://social.technet.microsoft.com/Forums/windows/en-US/a3968ec9-5824-4bc2-82a2-a37ea88c273a/sticky-keys-exploit), [ref2](http://carnal0wnage.attackresearch.com/2012/04/privilege-escalation-via-sticky-keys.html)\) |
| use post/windows/manage/vmdk\_mount | **Windows Manage VMDK Mount Drive** This module mounts a vmdk file \(Virtual Machine Disk\) on a drive provided by the user by taking advantage of the vstor2 device driver \(VMware\). \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/manage/vmdk_mount.rb), [ref1](http://www.shelliscoming.com/2017/05/post-exploitation-mounting-vmdk-files.html)\) |
| use post/windows/manage/vss\_create | **Windows Manage Create Shadow Copy** This module will attempt to create a new volume shadow copy. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/manage/vss_create.rb), [ref1](http://pauldotcom.com/2011/11/safely-dumping-hashes-from-liv.html)\) |
| use post/windows/manage/vss\_list | **Windows Manage List Shadow Copies** This module will attempt to list any Volume Shadow Copies on the system. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/manage/vss_list.rb), [ref1](http://pauldotcom.com/2011/11/safely-dumping-hashes-from-liv.html)\) |
| use post/windows/manage/vss\_mount | **Windows Manage Mount Shadow Copy** This module will attempt to mount a Volume Shadow Copy on the system. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/manage/vss_mount.rb), [ref1](http://pauldotcom.com/2011/11/safely-dumping-hashes-from-liv.html)\) |
| use post/windows/manage/vss\_set\_storage | **Windows Manage Set Shadow Copy Storage Space** This module will attempt to change the amount of space for volume shadow copy storage. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/manage/vss_set_storage.rb), [ref1](http://pauldotcom.com/2011/11/safely-dumping-hashes-from-liv.html)\) |
| use post/windows/manage/vss\_storage | **Windows Manage Get Shadow Copy Storage Info** This module will attempt to get volume shadow copy storage info. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/manage/vss_storage.rb), [ref1](http://pauldotcom.com/2011/11/safely-dumping-hashes-from-liv.html)\) |

Go [back to menu](https://www.infosecmatter.com/post-exploitation-metasploit-modules-reference/#toc).

### Active Directory post exploitation modules <a id="active_directory_post_exploitation_modules"></a>

#### Extract credentials \(Active Directory\) <a id="extract_credentials_active_directory"></a>

| Metasploit module | Description |
| :--- | :--- |
| use post/windows/gather/credentials/domain\_hashdump | **Windows Domain Controller Hashdump** This module attempts to copy the NTDS.dit database from a live Domain Controller and then parse out all of the User Accounts. It saves all of the captured password hashes, including historical ones. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/credentials/domain_hashdump.rb)\) |
| use post/windows/gather/credentials/enum\_laps | **Windows Gather Credentials Local Administrator Password Solution** This module will recover the LAPS \(Local Administrator Password Solution\) passwords, configured in Active Directory, which is usually only accessible by privileged users. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/credentials/enum_laps.rb)\) |
| use post/windows/gather/credentials/gpp | **Windows Gather Group Policy Preference Saved Passwords** This module enumerates the victim machine’s domain controller and connects to it via SMB. It then looks for Group Policy Preference XML files containing local user accounts and passwords \(cPassword\) and decrypts them using the publicly known AES key. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/credentials/gpp.rb), [ref1](https://msdn.microsoft.com/en-us/library/cc232604%28v=prot.13%29), [ref2](https://rewtdance.blogspot.com/2012/06/exploiting-windows-2008-group-policy.html), [ref3](http://blogs.technet.com/grouppolicy/archive/2009/04/22/passwords-in-group-policy-preferences-updated.aspx), [ref4](https://labs.portcullis.co.uk/blog/are-you-considering-using-microsoft-group-policy-preferences-think-again/)\) |
| use post/windows/gather/enum\_ad\_bitlocker | **Windows Gather Active Directory BitLocker Recovery** This module will enumerate BitLocker recovery passwords in the default AD directory. This module does require Domain Admin or other delegated privileges. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/enum_ad_bitlocker.rb), [ref1](https://technet.microsoft.com/en-us/library/cc771778%28v=ws.10%29.aspx)\) |
| use post/windows/gather/enum\_ad\_user\_comments | **Windows Gather Active Directory User Comments** This module will enumerate user accounts in the default Active Domain \(AD\) directory which contain ‘pass’ in their description or comment \(case-insensitive\) by default. In some cases, such users have their passwords specified in these fields. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/enum_ad_user_comments.rb), [ref1](http://social.technet.microsoft.com/wiki/contents/articles/5392.active-directory-ldap-syntax-filters.aspx)\) |
| use post/windows/gather/ntds\_grabber | **NTDS Grabber** This module uses a powershell script to obtain a copy of the ntds.dit SAM and SYSTEM files on a domain controller. It compresses all these files in a cabinet file called All.cab. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/ntds_grabber.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/windows/gather/ntds_grabber.md)\) |
| use post/windows/gather/ntds\_location | **Post Windows Gather NTDS.DIT Location** This module will find the location of the NTDS.DIT file \(from the Registry check that it exists, and display its location on the screen, which is useful if you wish to manually acquire the file using ntdsutil or vss. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/ntds_location.rb)\) |

Go [back to menu](https://www.infosecmatter.com/post-exploitation-metasploit-modules-reference/#toc).

#### Information gathering \(Active Directory\) <a id="information_gathering_active_directory"></a>

| Metasploit module | Description |
| :--- | :--- |
| use post/windows/gather/ad\_to\_sqlite | **AD Computer, Group and Recursive User Membership to Local SQLite DB** This module will gather a list of AD groups, identify the users \(taking into account recursion\) and write this to a SQLite database for offline analysis and query using normal SQL syntax. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/ad_to_sqlite.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/windows/gather/ad_to_sqlite.md)\) |
| use post/windows/gather/bloodhound | **BloodHound Ingestor** This module will execute the BloodHound C\# Ingestor \(aka SharpHound\) to gather sessions, local admin, domain trusts and more. With this information BloodHound will be able to identify attack paths that could lead to compromise of the Active Directory environment. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/bloodhound.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/windows/gather/bloodhound.md), [ref1](https://github.com/BloodHoundAD/BloodHound/)\) |
| use post/windows/gather/enum\_ad\_computers | **Windows Gather Active Directory Computers** This module will enumerate computers in the default AD directory. It allows fine grained enumeration to identify e.g. only domain controllers or only servers. It is also possible to define which information \(attributes\) should be retrieved. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/enum_ad_computers.rb), [ref1](http://social.technet.microsoft.com/wiki/contents/articles/5392.active-directory-ldap-syntax-filters.aspx)\) |
| use post/windows/gather/enum\_ad\_groups | **Windows Gather Active Directory Groups** This module will enumerate AD groups on the specified domain. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/enum_ad_groups.rb)\) |
| use post/windows/gather/enum\_ad\_managedby\_groups | **Windows Gather Active Directory Managed Groups** This module will enumerate AD groups on the specified domain which are specifically managed and list of the managers. This can identify privilege escalation opportunities or persistence mechanisms without having domain admin privileges. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/enum_ad_managedby_groups.rb)\) |
| use post/windows/gather/enum\_ad\_service\_principal\_names | **Windows Gather Active Directory Service Principal Names** This module will enumerate servicePrincipalName in the default AD directory where the user is a member of the Domain Admins group. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/enum_ad_service_principal_names.rb), [ref1](https://www.netspi.com/blog/entryid/214/faster-domain-escalation-using-ldap)\) |
| use post/windows/gather/enum\_ad\_to\_wordlist | **Windows Active Directory Wordlist Builder** This module will gather information from the default Active Domain \(AD\) directory and use these words to seed a wordlist. By default it enumerates user accounts to build the wordlist. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/enum_ad_to_wordlist.rb)\) |
| use post/windows/gather/enum\_ad\_users | **Windows Gather Active Directory Users** This module will enumerate user accounts in the default Active Domain \(AD\) directory and stores them in the database. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/enum_ad_users.rb)\) |
| use post/windows/gather/enum\_domain | **Windows Gather Enumerate Domain** This module identifies the primary domain via the registry. The registry value used is: HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Group Policy\History\DCName. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/enum_domain.rb)\) |
| use post/windows/gather/enum\_domains | **Windows Gather Domain Enumeration** This module enumerates currently the domains a host can see and the domain controllers for that domain. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/enum_domains.rb)\) |
| use post/windows/gather/enum\_domain\_group\_users | **Windows Gather Enumerate Domain Group** This module extracts user accounts from specified group and stores the results in the loot. It will also verify if session account is in the group. This module should be run over as session with domain credentials. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/enum_domain_group_users.rb)\) |
| use post/windows/gather/enum\_domain\_tokens | **Windows Gather Enumerate Domain Tokens** This module will enumerate tokens present on a system that are part of the domain the target host is part of. It will also enumerate users in the local Administrators, Users and Backup Operator groups to identify Domain members. Processes will be also enumerated and checked if they are running under a Domain account, on all checks the accounts, processes and tokens will be checked if they are part of the Domain Admin group of the domain the machine is a member of. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/enum_domain_tokens.rb)\) |
| use post/windows/gather/enum\_domain\_users | **Windows Gather Enumerate Active Domain Users** This module will enumerate all domain computers and check whether the target user has session on them. It is also possible to list which users are logged in on which computers using this module. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/enum_domain_users.rb)\) |
| use post/windows/gather/enum\_tokens | **Windows Gather Enumerate Domain Admin Tokens \(Token Hunter\)** This module will identify systems that have a Domain Admin \(delegation\) token on them. The module will first check if sufficient privileges are present for certain actions, and run getprivs for system. If you elevated privs to system, the SeAssignPrimaryTokenPrivilege will not be assigned, in that case try migrating to another process that is running as system. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/enum_tokens.rb)\) |
| use post/windows/gather/local\_admin\_search\_enum | **Windows Gather Local Admin Search** This module will identify systems in a given range that the supplied domain user \(should migrate into a user pid\) has administrative access to. It uses the Windows OpenSCManagerA API function. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/local_admin_search_enum.rb)\) |

Go [back to menu](https://www.infosecmatter.com/post-exploitation-metasploit-modules-reference/#toc).

#### Generic / Other \(Active Directory\) <a id="generic__other_active_directory"></a>

| Metasploit module | Description |
| :--- | :--- |
| use post/windows/manage/add\_user | **Windows Manage Add User to the Domain and/or to a Domain Group** This module adds a user to the Domain and/or to a Domain group. It will check if sufficient privileges are present and run getprivs for system, if needed. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/manage/add_user.rb)\) |

Go [back to menu](https://www.infosecmatter.com/post-exploitation-metasploit-modules-reference/#toc).

### Linux post exploitation modules <a id="linux_post_exploitation_modules"></a>

#### Extract credentials \(Linux\) <a id="extract_credentials_linux"></a>

| Metasploit module | Description |
| :--- | :--- |
| use post/linux/gather/ecryptfs\_creds | **Gather eCryptfs Metadata** This module will collect the contents of all users’ .ecrypts directories on the targeted machine. Collected “wrapped-passphrase” files can be cracked with John the Ripper \(JtR\) to recover the “mount passphrases”. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/linux/gather/ecryptfs_creds.rb)\) |
| use post/linux/gather/enum\_nagios\_xi | **Nagios XI Enumeration** NagiosXI may store credentials of the hosts it monitors. This module extracts these credentials, creating opportunities for lateral movement. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/linux/gather/enum_nagios_xi.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/linux/gather/enum_nagios_xi.md)\) |
| use post/linux/gather/enum\_psk | **Linux Gather 802-11-Wireless-Security Credentials** This module collects 802-11-Wireless-Security credentials such as Access-Point name and Pre-Shared-Key from your target CLIENT Linux machine using /etc/NetworkManager/system-connections/ files. The module gathers NetworkManager’s plaintext “psk” information. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/linux/gather/enum_psk.rb)\) |
| use post/linux/gather/gnome\_commander\_creds | **Linux Gather Gnome-Commander Creds** This module collects clear text passwords stored by Gnome-commander, a GUI file explorer for GNOME. Typically, these passwords are stored in the user’s home directory, at ~/.gnome-commander/connections. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/linux/gather/gnome_commander_creds.rb)\) |
| use post/linux/gather/gnome\_keyring\_dump | **Gnome-Keyring Dump** This module extracts network passwords for the current user stored in the GNOME Keyring. No need root privileges. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/linux/gather/gnome_keyring_dump.rb)\) |
| use post/linux/gather/hashdump | **Linux Gather Dump Password Hashes for Linux Systems** Post module to dump the password hashes for all users on a Linux System. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/linux/gather/hashdump.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/linux/gather/hashdump.md)\) |
| use post/linux/gather/mount\_cifs\_creds | **Linux Gather Saved mount.cifs/mount.smbfs Credentials** Post module to obtain credentials saved for mount.cifs/mount.smbfs in the /etc/fstab file on a Linux system. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/linux/gather/mount_cifs_creds.rb)\) |
| use post/linux/gather/openvpn\_credentials | **OpenVPN Gather Credentials** This module grabs OpenVPN credentials from a process listing on Linux. Note: –auth-nocache must not be set in the OpenVPN command line. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/linux/gather/openvpn_credentials.rb), [ref1](https://gist.github.com/rvrsh3ll/cc93a0e05e4f7145c9eb#file-openvpnscraper-sh)\) |
| use post/linux/gather/phpmyadmin\_credsteal | **Phpmyadmin credentials stealer** This module gathers PhpMyAdmin creds from the target linux machine. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/linux/gather/phpmyadmin_credsteal.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/linux/gather/phpmyadmin_credsteal.md)\) |
| use post/linux/gather/pptpd\_chap\_secrets | **Linux Gather PPTP VPN chap-secrets Credentials** This module collects PPTP VPN information such as client, server, password, and IP from your target server’s chap-secrets file. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/linux/gather/pptpd_chap_secrets.rb)\) |

Go [back to menu](https://www.infosecmatter.com/post-exploitation-metasploit-modules-reference/#toc).

#### Information gathering \(Linux\) <a id="information_gathering_linux"></a>

| Metasploit module | Description |
| :--- | :--- |
| use post/linux/gather/checkcontainer | **Linux Gather Container Detection** This module attempts to determine whether the system is running inside of a container. It supports detection of Docker, LXC, and systemd nspawn. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/linux/gather/checkcontainer.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/linux/gather/checkcontainer.md)\) |
| use post/linux/gather/checkvm | **Linux Gather Virtual Environment Detection** This module attempts to determine whether the system is running inside of a virtual environment. It supports detection of Hyper-V, VMWare, VirtualBox, Xen, and QEMU/KVM. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/linux/gather/checkvm.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/linux/gather/checkvm.md)\) |
| use post/linux/gather/enum\_commands | **Testing commands needed in a function** This module will list available commands on the target system, e.g. in the /bin/, /usr/bin, /sbin, /usr/sbin directories etc. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/linux/gather/enum_commands.rb)\) |
| use post/linux/gather/enum\_configs | **Linux Gather Configurations** This module collects configuration files found on commonly installed applications and services, such as Apache, MySQL, Samba, Sendmail, etc. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/linux/gather/enum_configs.rb)\) |
| use post/linux/gather/enum\_containers | **Linux Container Enumeration** This module attempts to enumerate containers on the target machine and optionally run a command on each active container found. Currently it supports Docker, LXC and RKT. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/linux/gather/enum_containers.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/linux/gather/enum_containers.md)\) |
| use post/linux/gather/enum\_network | **Linux Gather Network Information** This module gathers network information from the target system IPTables rules, interfaces, wireless information, open and listening ports, active network connections, DNS information and SSH information. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/linux/gather/enum_network.rb)\) |
| use post/linux/gather/enum\_protections | **Linux Gather Protection Enumeration** This module checks whether popular system hardening mechanisms are in place, such as SMEP, SMAP, SELinux, PaX and grsecurity. It also tries to find installed applications that can be used to hinder, prevent, or detect attacks, such as tripwire, snort, and apparmor. This module is meant to identify Linux Secure Modules \(LSM\) in addition to various antivirus, IDS/IPS, firewalls, sandboxes and other security related software. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/linux/gather/enum_protections.rb)\) |
| use post/linux/gather/enum\_system | **Linux Gather System and User Information** This module gathers system information. Ir collects installed packages, installed services, mount information, user list, user bash history and cron jobs. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/linux/gather/enum_system.rb)\) |
| use post/linux/gather/enum\_users\_history | **Linux Gather User History** This module gathers the following user-specific information: shell history, MySQL history, PostgreSQL history, MongoDB history, Vim history, lastlog, and sudoers. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/linux/gather/enum_users_history.rb)\) |
| use post/linux/gather/tor\_hiddenservices | **Linux Gather TOR Hidden Services** This module collects the hostnames and private keys of any TOR Hidden Services running on the target machine. Root permissions are required to read all Hidden Service directories, which are usually owned by a separate account. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/linux/gather/tor_hiddenservices.rb)\) |

Go [back to menu](https://www.infosecmatter.com/post-exploitation-metasploit-modules-reference/#toc).

#### Busybox related \(Linux\) <a id="busybox_related_linux"></a>

These modules will be applied on a session connected to a BusyBox shell.

| Metasploit module | Description |
| :--- | :--- |
| use post/linux/busybox/enum\_connections | **BusyBox Enumerate Connections** This module will be applied on a session connected to a BusyBox shell. It will enumerate the connections established with the router or device executing BusyBox. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/linux/busybox/enum_connections.rb)\) |
| use post/linux/busybox/enum\_hosts | **BusyBox Enumerate Host Names** This module will be applied on a session connected to a BusyBox shell. It will enumerate host names related to the device executing BusyBox. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/linux/busybox/enum_hosts.rb)\) |
| use post/linux/busybox/jailbreak | **BusyBox Jailbreak** This module will send a set of commands to an open session that is connected to a BusyBox limited shell \(i.e. a router limited shell\). It will try different known tricks to jailbreak the limited shell and get a full BusyBox shell. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/linux/busybox/jailbreak.rb)\) |
| use post/linux/busybox/ping\_net | **BusyBox Ping Network Enumeration** This module will be applied on a session connected to a BusyBox shell. It will ping a range of IP addresses from the router or device executing BusyBox. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/linux/busybox/ping_net.rb)\) |
| use post/linux/busybox/set\_dmz | **BusyBox DMZ Configuration** This module will be applied on a session connected to a BusyBox shell. It allows to manage traffic forwarding to a target host through the BusyBox device. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/linux/busybox/set_dmz.rb)\) |
| use post/linux/busybox/set\_dns | **BusyBox DNS Configuration** This module will be applied on a session connected to a BusyBox shell. It allows to set the DNS server on the device executing BusyBox so it will be sent by the DHCP server to network hosts. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/linux/busybox/set_dns.rb)\) |
| use post/linux/busybox/smb\_share\_root | **BusyBox SMB Sharing** This module will be applied on a session connected to a BusyBox shell. It will modify the SMB configuration of the device executing BusyBox to share the root directory of the device. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/linux/busybox/smb_share_root.rb)\) |
| use post/linux/busybox/wget\_exec | **BusyBox Download and Execute** This module will be applied on a session connected to a BusyBox shell. It will use wget to download and execute a file from the device running BusyBox. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/linux/busybox/wget_exec.rb)\) |

Go [back to menu](https://www.infosecmatter.com/post-exploitation-metasploit-modules-reference/#toc).

#### Generic / Other \(Linux\) <a id="generic__other_linux"></a>

| Metasploit module | Description |
| :--- | :--- |
| use post/linux/dos/xen\_420\_dos | **Linux DoS Xen 4.2.0 2012-5525** This module causes a hypervisor crash in Xen 4.2.0 when invoked from a paravirtualized VM, including from dom0. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/linux/dos/xen_420_dos.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/linux/dos/xen_420_dos.md)\) |
| use post/linux/manage/dns\_spoofing | **Native DNS Spoofing module** This module will redirect all DNS requests on the target Linux system to an arbitrary remote DNS server. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/linux/manage/dns_spoofing.rb)\) |
| use post/linux/manage/download\_exec | **Linux Manage Download and Execute** This module downloads and runs a file with bash. It first tries to uses curl as its HTTP client and then wget if it’s not found. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/linux/manage/download_exec.rb)\) |
| use post/linux/manage/iptables\_removal | **IPTABLES rules removal** This module will completely remove all IPTABLES rules on the target system, including NAT rules. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/linux/manage/iptables_removal.rb)\) |
| use post/linux/manage/pseudo\_shell | **Pseudo-Shell Post-Exploitation Module** This module will run a Pseudo-Shell. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/linux/manage/pseudo_shell.rb)\) |
| use post/linux/manage/sshkey\_persistence | **SSH Key Persistence** This module will add an SSH key to a specified user \(or all\), to allow remote login via SSH at any time. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/linux/manage/sshkey_persistence.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/linux/manage/sshkey_persistence.md)\) |

Go [back to menu](https://www.infosecmatter.com/post-exploitation-metasploit-modules-reference/#toc).

### Mac OS X post exploitation Metasploit modules <a id="mac_os_x_post_exploitation_metasploit_modules"></a>

#### Extract credentials \(Mac OS X\) <a id="extract_credentials_mac_os_x"></a>

| Metasploit module | Description |
| :--- | :--- |
| use post/osx/gather/apfs\_encrypted\_volume\_passwd | **Mac OS X APFS Encrypted Volume Password Disclosure** This module exploits a flaw in OSX 10.13 through 10.13.3 that discloses the passwords of encrypted APFS volumes. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/osx/gather/apfs_encrypted_volume_passwd.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/osx/gather/apfs_encrypted_volume_passwd.md), [ref1](https://thehackernews.com/2018/03/macos-apfs-password.html), [ref2](https://www.mac4n6.com/blog/2018/3/21/uh-oh-unified-logs-in-high-sierra-1013-show-plaintext-password-for-apfs-encrypted-external-volumes-via-disk-utilityapp)\) |
| use post/osx/gather/autologin\_password | **OSX Gather Autologin Password as Root** This module will steal the plaintext password of any user on the machine with autologin enabled. Root access is required. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/osx/gather/autologin_password.rb), [ref1](http://www.brock-family.org/gavin/perl/kcpassword.html)\) |
| use post/osx/gather/enum\_keychain | **OS X Gather Keychain Enumeration** This module presents a way to quickly go through the current user’s keychains and collect data such as email accounts, servers, passwords and other data. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/osx/gather/enum_keychain.rb)\) |
| use post/osx/gather/hashdump | **OS X Gather Mac OS X Password Hash Collector** This module dumps SHA-1, LM, NT, and SHA-512 Hashes on OSX. Supports versions 10.3 to 10.14. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/osx/gather/hashdump.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/osx/gather/hashdump.md)\) |
| use post/osx/gather/password\_prompt\_spoof | **OSX Password Prompt Spoof** Presents a password prompt dialog to a logged-in OSX user. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/osx/gather/password_prompt_spoof.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/osx/gather/password_prompt_spoof.md), [ref1](http://blog.packetheader.net/2011/10/fun-with-applescript.html)\) |
| use post/osx/gather/vnc\_password\_osx | **OS X Display Apple VNC Password** This module shows Apple VNC Password from Mac OS X High Sierra. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/osx/gather/vnc_password_osx.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/osx/gather/vnc_password_osx.md)\) |

Go [back to menu](https://www.infosecmatter.com/post-exploitation-metasploit-modules-reference/#toc).

#### Information gathering \(Mac OS X\) <a id="information_gathering_mac_os_x"></a>

| Metasploit module | Description |
| :--- | :--- |
| use post/osx/gather/enum\_adium | **OS X Gather Adium Enumeration** This module will collect Adium’s account plist files and chat logs from the victim’s machine. It also allows to search for pattern to look for in the chat logs. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/osx/gather/enum_adium.rb)\) |
| use post/osx/gather/enum\_airport | **OS X Gather Airport Wireless Preferences** This module will download OS X Airport Wireless preferences from the victim machine. The preferences file \(which is a plist\) contains information such as: SSID, Channels, Security Type, Password ID, etc. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/osx/gather/enum_airport.rb)\) |
| use post/osx/gather/enum\_chicken\_vnc\_profile | **OS X Gather Chicken of the VNC Profile** This module will download the “Chicken of the VNC” client application’s profile file, which is used to store other VNC servers’ information such as the IP and password. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/osx/gather/enum_chicken_vnc_profile.rb)\) |
| use post/osx/gather/enum\_colloquy | **OS X Gather Colloquy Enumeration** This module will collect Colloquy’s info plist file and chat logs from the victim’s machine. It also allows to search for a specific patterns in the chat logs. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/osx/gather/enum_colloquy.rb)\) |
| use post/osx/gather/enum\_messages | **OS X Gather Messages** This module will collect the Messages sqlite3 database files and chat logs from the victim’s machine. There are four actions you may choose: DBFILE, READABLE, LATEST, and ALL. DBFILE and READABLE will retrieve all messages, and LATEST will retrieve the last X number of messages \(useful with 2FA\). \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/osx/gather/enum_messages.rb)\) |
| use post/osx/gather/enum\_osx | **OS X Gather Mac OS X System Information Enumeration** This module gathers basic system information from Mac OS X Tiger \(10.4\), through Mojave \(10.14\). \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/osx/gather/enum_osx.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/osx/gather/enum_osx.md)\) |
| use post/osx/gather/safari\_lastsession | **OSX Gather Safari LastSession.plist** This module downloads the LastSession.plist file from the target machine. LastSession.plist is used by Safari to track active websites in the current session, and sometimes contains sensitive information such as usernames and passwords. This module will first download the original LastSession.plist, and then attempt to find the credential for Gmail. The Gmail’s last session state may contain the user’s credential if his/her first login attempt failed \(likely due to a typo and then the page got refreshed or another login attempt was made. This also means the stolen credential might contain typos. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/osx/gather/safari_lastsession.rb), [ref1](https://www.securelist.com/en/blog/8168/Loophole_in_Safari)\) |

Go [back to menu](https://www.infosecmatter.com/post-exploitation-metasploit-modules-reference/#toc).

#### Spy / Capture \(Mac OS X\) <a id="spy__capture_mac_os_x"></a>

| Metasploit module | Description |
| :--- | :--- |
| use post/osx/capture/keylog\_recorder | **OSX Capture Userspace Keylogger** Logs all keyboard events except cmd-keys and GUI password input. Keylogs are transferred between client/server in chunks every SYNCWAIT seconds for reliability. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/osx/capture/keylog_recorder.rb)\) |
| use post/osx/capture/screen | **OSX Screen Capture** This module takes screenshots of target desktop and automatically downloads them. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/osx/capture/screen.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/osx/capture/screen.md)\) |
| use post/osx/manage/record\_mic | **OSX Manage Record Microphone** This module will allow the user to detect \(with the LIST action\) and capture \(with the RECORD action\) audio inputs on a remote OSX machine. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/osx/manage/record_mic.rb)\) |
| use post/osx/manage/webcam | **OSX Manage Webcam** This module will allow the user to detect installed webcams \(with the LIST action\), take a snapshot \(with the SNAPSHOT action\), or record a webcam and mic \(with the RECORD action\). \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/osx/manage/webcam.rb)\) |

Go [back to menu](https://www.infosecmatter.com/post-exploitation-metasploit-modules-reference/#toc).

#### Generic / Other \(Mac OS X\) <a id="generic__other_mac_os_x"></a>

| Metasploit module | Description |
| :--- | :--- |
| use post/osx/admin/say | **OS X Text to Speech Utility** This module will speak whatever is in the ‘TEXT’ option on the victim machine. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/osx/admin/say.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/osx/admin/say.md), [ref1](http://www.gabrielserafini.com/blog/2008/08/19/mac-os-x-voices-for-using-with-the-say-command/)\) |
| use post/osx/escalate/tccbypass | **Bypass the macOS TCC Framework** This module exploits a vulnerability in the TCC daemon on macOS Catalina \(≤ 10.15.5\) in order to grant TCC entitlements. The TCC daemon can be manipulated \(by setting the HOME environment variable\) to use a new user controlled location as the TCC database. We can then grant ourselves entitlements by inserting them into this new database. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/osx/escalate/tccbypass.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/osx/escalate/tccbypass.md), [ref1](https://medium.com/@mattshockl/cve-2020-9934-bypassing-the-os-x-transparency-consent-and-control-tcc-framework-for-4e14806f1de8), [ref2](https://github.com/mattshockl/CVE-2020-9934)\) |
| use post/osx/manage/mount\_share | **OSX Network Share Mounter** This module lists saved network shares and tries to connect to them using stored credentials. This does not require root privileges. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/osx/manage/mount_share.rb)\) |
| use post/osx/manage/sonic\_pi | **OS X Manage Sonic Pi** This module controls Sonic Pi via its local OSC server. The server runs on 127.0.0.1:4557 and receives OSC messages over UDP. Yes, this is RCE, but it’s local. I suggest playing music 🙂 \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/osx/manage/sonic_pi.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/osx/manage/sonic_pi.md), [ref1](https://sonic-pi.net/), [ref2](https://github.com/samaaron/sonic-pi/wiki/Sonic-Pi-Internals----GUI-Ruby-API), [ref3](http://opensoundcontrol.org/spec-1_0)\) |
| use post/osx/manage/vpn | **OSX VPN Manager** This module lists VPN connections and tries to connect to them using stored credentials. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/osx/manage/vpn.rb)\) |

Go [back to menu](https://www.infosecmatter.com/post-exploitation-metasploit-modules-reference/#toc).

### UNIX post exploitation modules <a id="unix_post_exploitation_modules"></a>

#### AIX post exploitation <a id="aix_post_exploitation"></a>

| Metasploit module | Description |
| :--- | :--- |
| use post/aix/hashdump | **AIX Gather Dump Password Hashes** Post module to dump the password hashes for all users on an AIX System. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/aix/hashdump.rb)\) |

#### BSD post exploitation <a id="bsd_post_exploitation"></a>

| Metasploit module | Description |
| :--- | :--- |
| use post/bsd/gather/hashdump | **BSD Dump Password Hashes** Post module to dump the password hashes for all users on a BSD system. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/bsd/gather/hashdump.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/bsd/gather/hashdump.md)\) |

#### Solaris post exploitation <a id="solaris_post_exploitation"></a>

| Metasploit module | Description |
| :--- | :--- |
| use post/solaris/escalate/pfexec | **Solaris pfexec Upgrade Shell** This module attempts to upgrade a shell session to UID 0 using pfexec. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/solaris/escalate/pfexec.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/solaris/escalate/pfexec.md), [ref1](https://docs.oracle.com/cd/E19253-01/816-4557/prbactm-1/index.html), [ref2](http://www.c0t0d0s0.org/archives/4844-Less-known-Solaris-features-pfexec.html), [ref3](http://solaris.wikia.com/wiki/Providing_root_privileges_with_pfexec)\) |
| use post/solaris/escalate/srsexec\_readline | **Solaris srsexec Arbitrary File Reader** This module exploits a vulnerability in NetCommander 3.2.3 and 3.2.5. The most widely accepted exploitation vector is reading /etc/shadow, which will reveal root’s hash for cracking. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/solaris/escalate/srsexec_readline.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/solaris/escalate/srsexec_readline.md), [ref1](https://download.oracle.com/sunalerts/1000443.1.html), [ref2](https://www.securityfocus.com/archive/1/468235)\) |
| use post/solaris/gather/checkvm | **Solaris Gather Virtual Environment Detection** This module attempts to determine whether the system is running inside of a virtual environment and if so, which one. This module supports detection of Solaris Zone, VMWare, VirtualBox, Xen, and QEMU/KVM. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/solaris/gather/checkvm.rb)\) |
| use post/solaris/gather/enum\_packages | **Solaris Gather Installed Packages** Post module to enumerate installed packages on a Solaris System. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/solaris/gather/enum_packages.rb)\) |
| use post/solaris/gather/enum\_services | **Solaris Gather Configured Services** Post module to enumerate services on a Solaris System. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/solaris/gather/enum_services.rb)\) |
| use post/solaris/gather/hashdump | **Solaris Gather Dump Password Hashes for Solaris Systems** Post module to dump the password hashes for all users on a Solaris System. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/solaris/gather/hashdump.rb)\) |

Go [back to menu](https://www.infosecmatter.com/post-exploitation-metasploit-modules-reference/#toc).

### Browser post exploitation modules <a id="browser_post_exploitation_modules"></a>

#### Mozilla Firefox post exploitation <a id="mozilla_firefox_post_exploitation"></a>

| Metasploit module | Description |
| :--- | :--- |
| use post/firefox/gather/cookies | **Firefox Gather Cookies from Privileged Javascript Shell** This module allows collection of cookies from a Firefox Privileged Javascript Shell. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/firefox/gather/cookies.rb)\) |
| use post/firefox/gather/history | **Firefox Gather History from Privileged Javascript Shell** This module allows collection of the entire browser history from a Firefox Privileged Javascript Shell. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/firefox/gather/history.rb)\) |
| use post/firefox/gather/passwords | **Firefox Gather Passwords from Privileged Javascript Shell** This module allows collection of passwords from a Firefox Privileged Javascript Shell. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/firefox/gather/passwords.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/firefox/gather/passwords.md)\) |
| use post/firefox/gather/xss | **Firefox XSS** This module runs the provided SCRIPT as JavaScript in the origin of the provided URL. It works by navigating to a hidden ChromeWindow to the URL, then injecting the SCRIPT with Function\(\). The callback “send\(result\)” is used to send data back to the listener. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/firefox/gather/xss.rb)\) |
| use post/firefox/manage/webcam\_chat | **Firefox Webcam Chat on Privileged Javascript Shell** This module allows streaming a webcam from a privileged Firefox Javascript shell. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/firefox/manage/webcam_chat.rb), [ref1](http://www.rapid7.com/db/modules/exploit/firefox/local/exec_shellcode)\) |
| use post/multi/gather/firefox\_creds | **Multi Gather Firefox Signon Credential Collection** This module will collect credentials and cookies from the Firefox web browser found on the system. Firefox stores passwords within the signons.sqlite database file. There is also a keys3.db file which contains the key for decrypting these passwords. In cases where a Master Password has not been set, the passwords can easily be decrypted using the referenced 3rd party tools or by setting the DECRYPT option to true. Platforms: bsd, linux, osx, unix, win \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/multi/gather/firefox_creds.rb), [ref1](https://github.com/Unode/firefox_decrypt), [ref2](https://github.com/philsmd/pswRecovery4Moz)\) |

#### Google Chrome post exploitation <a id="google_chrome_post_exploitation"></a>

| Metasploit module | Description |
| :--- | :--- |
| use post/multi/gather/chrome\_cookies | **Chrome Gather Cookies** Read all cookies from the Default Chrome profile of the target user. Platforms: linux, unix, bsd, osx, windows \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/multi/gather/chrome_cookies.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/multi/gather/chrome_cookies.md)\) |
| use post/windows/gather/enum\_chrome | **Windows Gather Google Chrome User Data Enumeration** This module will collect user data from Google Chrome and attempt to decrypt sensitive information. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/enum_chrome.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/windows/gather/enum_chrome.md)\) |

#### Internet Explorer post exploitation <a id="internet_explorer_post_exploitation"></a>

| Metasploit module | Description |
| :--- | :--- |
| use post/windows/gather/enum\_ie | **Windows Gather Internet Explorer User Data Enumeration** This module will collect history, cookies, and credentials \(from either HTTP auth passwords, or saved form passwords found in auto-complete\) in Internet Explorer. The ability to gather credentials is only supported for versions of IE ≥7, while history and cookies can be extracted for all versions. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/enum_ie.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/windows/gather/enum_ie.md)\) |
| use post/windows/manage/ie\_proxypac | **Windows Manage Proxy PAC File** This module configures Internet Explorer to use a PAC proxy file. By using the LOCAL\_PAC option, a PAC file will be created on the victim host. It’s also possible to provide a remote PAC file \(REMOTE\_PAC option\) by providing the full URL. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/manage/ie_proxypac.rb), [ref1](https://www.youtube.com/watch?v=YGjIlbBVDqE&hd=1), [ref2](http://blog.scriptmonkey.eu/bypassing-group-policy-using-the-windows-registry)\) |

#### Multi browser post exploitation <a id="multi_browser_post_exploitation"></a>

| Metasploit module | Description |
| :--- | :--- |
| use post/multi/manage/hsts\_eraser | **Web browsers HSTS entries eraser** This module removes the HSTS \(HTTP Strict Transport Security\) database of the following tools and web browsers: Mozilla Firefox, Google Chrome, Opera, Safari and wget. Platforms: linux, osx, unix, win \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/multi/manage/hsts_eraser.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/multi/manage/hsts_eraser.md), [ref1](http://blog.en.elevenpaths.com/2017/12/breaking-out-hsts-and-hpkp-on-firefox.html), [ref2](https://www.blackhat.com/docs/eu-17/materials/eu-17-Berta-Breaking-Out-HSTS-And-HPKP-On-Firefox-IE-Edge-And-Possibly-Chrome.pdf)\) |
| use post/windows/gather/forensics/browser\_history | **Windows Gather Skype, Firefox, and Chrome Artifacts** Gathers Skype chat logs, Firefox history, and Chrome history data from the target machine. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/forensics/browser_history.rb)\) |

Go [back to menu](https://www.infosecmatter.com/post-exploitation-metasploit-modules-reference/#toc).

### Hardware post exploitation modules <a id="hardware_post_exploitation_modules"></a>

#### Automotive post exploitation <a id="automotive_post_exploitation"></a>

| Metasploit module | Description |
| :--- | :--- |
| use post/hardware/automotive/canprobe | **Module to Probe Different Data Points in a CAN Packet** Scans between two CAN IDs and writes data at each byte position. It will either write a set byte value \(Default 0xFF\) or iterate through all possible values of that byte position \(takes much longer\). Does not check for responses and is basically a simple blind fuzzer. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/hardware/automotive/canprobe.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/hardware/automotive/canprobe.md)\) |
| use post/hardware/automotive/can\_flood | **CAN Flood** This module floods a CAN interface with supplied frames. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/hardware/automotive/can_flood.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/hardware/automotive/can_flood.md)\) |
| use post/hardware/automotive/getvinfo | **Get the Vehicle Information Such as the VIN from the Target Module** Post module to query DTCs, Some common engine info and Vehicle Info. It returns such things as engine speed, coolant temp, Diagnostic Trouble Codes as well as All info stored by Mode $09 Vehicle Info, VIN, etc. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/hardware/automotive/getvinfo.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/hardware/automotive/getvinfo.md)\) |
| use post/hardware/automotive/identifymodules | **Scan CAN Bus for Diagnostic Modules** Post module to scan the CAN bus for any modules that can respond to UDS DSC queries. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/hardware/automotive/identifymodules.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/hardware/automotive/identifymodules.md)\) |
| use post/hardware/automotive/malibu\_overheat | **Sample Module to Flood Temp Gauge on 2006 Malibu** Simple sample temp flood for the 2006 Chevrolet Malibu. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/hardware/automotive/malibu_overheat.rb)\) |
| use post/hardware/automotive/mazda\_ic\_mover | **Mazda 2 Instrument Cluster Accelorometer Mover** This module moves the needle of the accelorometer and speedometer of the Mazda 2 instrument cluster. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/hardware/automotive/mazda_ic_mover.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/hardware/automotive/mazda_ic_mover.md)\) |
| use post/hardware/automotive/pdt | **Check For and Prep the Pyrotechnic Devices \(Airbags, Battery Clamps, etc.\)** Acting in the role of a Pyrotechnical Device Deployment Tool \(PDT\), this module will first query all Pyrotechnic Control Units \(PCUs\) in the target vehicle to discover how many pyrotechnic devices are present, then attempt to validate the security access token using the default simplified algorithm. On success, the vehicle will be in a state that is prepped to deploy its pyrotechnic devices \(e.g. airbags, battery clamps, etc.\) via the service routine. \(ISO 26021\). \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/hardware/automotive/pdt.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/hardware/automotive/pdt.md), [ref1](https://www.researchgate.net/publication/321183727_Security_Evaluation_of_an_Airbag-ECU_by_Reusing_Threat_Modeling_Artefacts)\) |

Go [back to menu](https://www.infosecmatter.com/post-exploitation-metasploit-modules-reference/#toc).

#### Networking equipment post exploitation <a id="networking_equipment_post_exploitation"></a>

| Metasploit module | Description |
| :--- | :--- |
| use post/hardware/zigbee/zstumbler | **Sends Beacons to Scan for Active ZigBee Networks** Post module to send beacon signals to the broadcast address while channel hopping. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/hardware/zigbee/zstumbler.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/hardware/zigbee/zstumbler.md)\) |
| use post/networking/gather/enum\_brocade | **Brocade Gather Device General Information** This module collects Brocade device information and configuration. It has been tested against an icx6430 running 08.0.20T311. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/networking/gather/enum_brocade.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/networking/gather/enum_brocade.md)\) |
| use post/networking/gather/enum\_cisco | **Cisco Gather Device General Information** This module collects a Cisco IOS or NXOS device information and configuration. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/networking/gather/enum_cisco.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/networking/gather/enum_cisco.md)\) |
| use post/networking/gather/enum\_f5 | **F5 Gather Device General Information** This module collects a F5’s device information and configuration. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/networking/gather/enum_f5.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/networking/gather/enum_f5.md)\) |
| use post/networking/gather/enum\_juniper | **Juniper Gather Device General Information** This module collects a Juniper ScreenOS and JunOS device information and configuration. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/networking/gather/enum_juniper.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/networking/gather/enum_juniper.md)\) |
| use post/networking/gather/enum\_mikrotik | **Mikrotik Gather Device General Information** This module collects Mikrotik device information and configuration. It has been tested against RouterOS 6.45.9. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/networking/gather/enum_mikrotik.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/networking/gather/enum_mikrotik.md)\) |
| use post/networking/gather/enum\_vyos | **VyOS Gather Device General Information** This module collects VyOS device information and configuration. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/networking/gather/enum_vyos.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/networking/gather/enum_vyos.md)\) |

Go [back to menu](https://www.infosecmatter.com/post-exploitation-metasploit-modules-reference/#toc).

#### Radio-frequency devices post exploitation <a id="radio-frequency_devices_post_exploitation"></a>

| Metasploit module | Description |
| :--- | :--- |
| use post/hardware/rftransceiver/rfpwnon | **Brute Force AM/OOK \(ie: Garage Doors\)** Post module for HWBridge RFTranscievers. Brute forces AM OOK or raw binary signals. This is a port of the rfpwnon tool by Corey Harding. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/hardware/rftransceiver/rfpwnon.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/hardware/rftransceiver/rfpwnon.md), [ref1](https://github.com/exploitagency/github-rfpwnon/blob/master/rfpwnon.py)\) |
| use post/hardware/rftransceiver/transmitter | **RF Transceiver Transmitter** This module powers an HWBridge-connected radio transceiver, effectively transmitting on the frequency set by the FREQ option. NOTE: Users of this module should be aware of their local laws, regulations, and licensing requirements for transmitting on any given radio frequency. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/hardware/rftransceiver/transmitter.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/hardware/rftransceiver/transmitter.md), [ref1](https://github.com/AndrewMohawk/RfCatHelpers)\) |

Go [back to menu](https://www.infosecmatter.com/post-exploitation-metasploit-modules-reference/#toc).

### Mobile devices post exploitation modules <a id="mobile_devices_post_exploitation_modules"></a>

#### Android post exploitation <a id="android_post_exploitation"></a>

| Metasploit module | Description |
| :--- | :--- |
| use post/android/capture/screen | **Android Screen Capture** This module takes a screenshot of the target phone display screen. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/android/capture/screen.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/android/capture/screen.md)\) |
| use post/android/gather/hashdump | **Android Gather Dump Password Hashes for Android Systems** Post module to dump the password hashes for Android System. Root is required. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/android/gather/hashdump.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/android/gather/hashdump.md), [ref1](https://www.pentestpartners.com/security-blog/cracking-android-passwords-a-how-to/), [ref2](https://hashcat.net/forum/thread-2202.html)\) |
| use post/android/gather/sub\_info | **Extracts subscriber info from target device** This module displays the subscriber info stored on the target phone. It uses call service to get values of each transaction code like imei etc. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/android/gather/sub_info.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/android/gather/sub_info.md)\) |
| use post/android/gather/wireless\_ap | **Displays wireless SSIDs and PSKs** This module displays all wireless AP creds saved on the target device. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/android/gather/wireless_ap.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/android/gather/wireless_ap.md)\) |
| use post/android/manage/remove\_lock | **Android Settings Remove Device Locks \(4.0-4.3\)** This module exploits a bug in the Android 4.0 to 4.3 com.android.settings.ChooseLockGeneric class. Any unprivileged app can exploit this vulnerability to remove the lockscreen and the device will be unlocked by a swipe. This vulnerability was patched in Android 4.4. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/android/manage/remove_lock.rb), [ref1](http://blog.curesec.com/article/blog/26.html), [ref2](http://www.curesec.com/data/advisories/Curesec-2013-1011.pdf)\) |
| use post/android/manage/remove\_lock\_root | **Android Root Remove Device Locks \(root\)** This module uses root privileges to remove the device lock. In some cases the original lock method will still be present but any key/gesture will unlock the device. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/android/manage/remove_lock_root.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/android/manage/remove_lock_root.md)\) |

Go [back to menu](https://www.infosecmatter.com/post-exploitation-metasploit-modules-reference/#toc).

#### Apple iOS post exploitation <a id="apple_ios_post_exploitation"></a>

| Metasploit module | Description |
| :--- | :--- |
| use post/apple\_ios/gather/ios\_image\_gather | **iOS Image Gatherer** This module collects images from iPhones. Module was tested on iOS 10.3.3 on an iPhone 5. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/apple_ios/gather/ios_image_gather.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/apple_ios/gather/ios_image_gather.md)\) |
| use post/apple\_ios/gather/ios\_text\_gather | **iOS Text Gatherer** This module collects text messages from iPhones. Tested on iOS 10.3.3 on an iPhone 5. \([source](https://github.com/rapid7/metasploit-framework/blob/master/modules/post/apple_ios/gather/ios_text_gather.rb), [docs](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/apple_ios/gather/ios_text_gather.md)\) |

### Reference <a id="conclusion"></a>

[https://www.infosecmatter.com/post-exploitation-metasploit-modules-reference/\#windows\_post\_exploitation\_modules](https://www.infosecmatter.com/post-exploitation-metasploit-modules-reference/#windows_post_exploitation_modules)

